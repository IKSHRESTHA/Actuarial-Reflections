<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Krishna Kumar Shrestha">
<meta name="dcterms.date" content="2025-07-13">
<meta name="description" content="A beginner-friendly guide to portfolio optimization using Mean Variance Analysis in R. Learn how to build optimal portfolios that balance risk and return.">

<title>Portfolio Optimization: A Simple Guide to Mean Variance Analysis – Actuarial-Reflections</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LSZ7YTNKVY"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LSZ7YTNKVY', { 'anonymize_ip': true});
</script>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Actuarial-Reflections</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../all-blogs.html"> 
<span class="menu-text">All Blog Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/IKSHRESTHA"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/ikshrestha/"> <i class="bi bi-linkedin" role="img" aria-label="LinkedIn">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#portfolio-optimization-a-simple-guide-to-mean-variance-analysis" id="toc-portfolio-optimization-a-simple-guide-to-mean-variance-analysis" class="nav-link active" data-scroll-target="#portfolio-optimization-a-simple-guide-to-mean-variance-analysis">Portfolio Optimization: A Simple Guide to Mean Variance Analysis</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#portfolio-optimization-theoretical-framework" id="toc-portfolio-optimization-theoretical-framework" class="nav-link" data-scroll-target="#portfolio-optimization-theoretical-framework">Portfolio Optimization: Theoretical Framework</a></li>
  <li><a href="#risk-and-return-analysis" id="toc-risk-and-return-analysis" class="nav-link" data-scroll-target="#risk-and-return-analysis">Risk and Return Analysis</a>
  <ul class="collapse">
  <li><a href="#expected-return" id="toc-expected-return" class="nav-link" data-scroll-target="#expected-return">Expected Return</a></li>
  <li><a href="#risk-measurement" id="toc-risk-measurement" class="nav-link" data-scroll-target="#risk-measurement">Risk Measurement</a></li>
  <li><a href="#the-risk-return-trade-off" id="toc-the-risk-return-trade-off" class="nav-link" data-scroll-target="#the-risk-return-trade-off">The Risk-Return Trade-off</a></li>
  </ul></li>
  <li><a href="#mean-variance-optimization-framework" id="toc-mean-variance-optimization-framework" class="nav-link" data-scroll-target="#mean-variance-optimization-framework">Mean Variance Optimization Framework</a></li>
  <li><a href="#theoretical-assumptions" id="toc-theoretical-assumptions" class="nav-link" data-scroll-target="#theoretical-assumptions">Theoretical Assumptions</a>
  <ul class="collapse">
  <li><a href="#rational-investor-behavior" id="toc-rational-investor-behavior" class="nav-link" data-scroll-target="#rational-investor-behavior">1. Rational Investor Behavior</a></li>
  <li><a href="#normal-distribution-of-returns" id="toc-normal-distribution-of-returns" class="nav-link" data-scroll-target="#normal-distribution-of-returns">2. Normal Distribution of Returns</a></li>
  <li><a href="#mean-variance-preferences" id="toc-mean-variance-preferences" class="nav-link" data-scroll-target="#mean-variance-preferences">3. Mean-Variance Preferences</a></li>
  <li><a href="#single-period-framework" id="toc-single-period-framework" class="nav-link" data-scroll-target="#single-period-framework">4. Single-Period Framework</a></li>
  <li><a href="#frictionless-markets" id="toc-frictionless-markets" class="nav-link" data-scroll-target="#frictionless-markets">5. Frictionless Markets</a></li>
  <li><a href="#homogeneous-expectations" id="toc-homogeneous-expectations" class="nav-link" data-scroll-target="#homogeneous-expectations">6. Homogeneous Expectations</a></li>
  </ul></li>
  <li><a href="#empirical-implementation" id="toc-empirical-implementation" class="nav-link" data-scroll-target="#empirical-implementation">Empirical Implementation</a>
  <ul class="collapse">
  <li><a href="#environment-configuration" id="toc-environment-configuration" class="nav-link" data-scroll-target="#environment-configuration">1. Environment Configuration</a></li>
  <li><a href="#data-acquisition-and-preprocessing" id="toc-data-acquisition-and-preprocessing" class="nav-link" data-scroll-target="#data-acquisition-and-preprocessing">2. Data Acquisition and Preprocessing</a></li>
  <li><a href="#return-calculation-and-statistical-analysis" id="toc-return-calculation-and-statistical-analysis" class="nav-link" data-scroll-target="#return-calculation-and-statistical-analysis">3. Return Calculation and Statistical Analysis</a></li>
  <li><a href="#correlation-structure-analysis" id="toc-correlation-structure-analysis" class="nav-link" data-scroll-target="#correlation-structure-analysis">4. Correlation Structure Analysis</a></li>
  <li><a href="#optimization-algorithm-implementation" id="toc-optimization-algorithm-implementation" class="nav-link" data-scroll-target="#optimization-algorithm-implementation">5. Optimization Algorithm Implementation</a></li>
  <li><a href="#finding-optimal-portfolios" id="toc-finding-optimal-portfolios" class="nav-link" data-scroll-target="#finding-optimal-portfolios">6. Finding Optimal Portfolios</a></li>
  <li><a href="#creating-the-efficient-frontier" id="toc-creating-the-efficient-frontier" class="nav-link" data-scroll-target="#creating-the-efficient-frontier">7. Creating the Efficient Frontier</a></li>
  </ul></li>
  <li><a href="#practical-example-building-your-portfolio" id="toc-practical-example-building-your-portfolio" class="nav-link" data-scroll-target="#practical-example-building-your-portfolio">Practical Example: Building Your Portfolio</a></li>
  <li><a href="#advantages-of-mean-variance-optimization" id="toc-advantages-of-mean-variance-optimization" class="nav-link" data-scroll-target="#advantages-of-mean-variance-optimization">Advantages of Mean Variance Optimization</a>
  <ul class="collapse">
  <li><a href="#mathematical-rigor-and-theoretical-foundation" id="toc-mathematical-rigor-and-theoretical-foundation" class="nav-link" data-scroll-target="#mathematical-rigor-and-theoretical-foundation">1. <strong>Mathematical Rigor and Theoretical Foundation</strong></a></li>
  <li><a href="#systematic-risk-management" id="toc-systematic-risk-management" class="nav-link" data-scroll-target="#systematic-risk-management">2. <strong>Systematic Risk Management</strong></a></li>
  <li><a href="#flexibility-and-customization" id="toc-flexibility-and-customization" class="nav-link" data-scroll-target="#flexibility-and-customization">3. <strong>Flexibility and Customization</strong></a></li>
  <li><a href="#empirical-and-practical-applications" id="toc-empirical-and-practical-applications" class="nav-link" data-scroll-target="#empirical-and-practical-applications">4. <strong>Empirical and Practical Applications</strong></a></li>
  </ul></li>
  <li><a href="#limitations-and-critical-assessment" id="toc-limitations-and-critical-assessment" class="nav-link" data-scroll-target="#limitations-and-critical-assessment">Limitations and Critical Assessment</a>
  <ul class="collapse">
  <li><a href="#parameter-estimation-risk" id="toc-parameter-estimation-risk" class="nav-link" data-scroll-target="#parameter-estimation-risk">1. <strong>Parameter Estimation Risk</strong></a></li>
  <li><a href="#input-sensitivity-and-instability" id="toc-input-sensitivity-and-instability" class="nav-link" data-scroll-target="#input-sensitivity-and-instability">2. <strong>Input Sensitivity and Instability</strong></a></li>
  <li><a href="#concentration-risk" id="toc-concentration-risk" class="nav-link" data-scroll-target="#concentration-risk">3. <strong>Concentration Risk</strong></a></li>
  <li><a href="#distributional-assumptions" id="toc-distributional-assumptions" class="nav-link" data-scroll-target="#distributional-assumptions">4. <strong>Distributional Assumptions</strong></a></li>
  <li><a href="#single-period-limitation" id="toc-single-period-limitation" class="nav-link" data-scroll-target="#single-period-limitation">5. <strong>Single-Period Limitation</strong></a></li>
  <li><a href="#market-frictions" id="toc-market-frictions" class="nav-link" data-scroll-target="#market-frictions">6. <strong>Market Frictions</strong></a></li>
  </ul></li>
  <li><a href="#improving-mean-variance-optimization" id="toc-improving-mean-variance-optimization" class="nav-link" data-scroll-target="#improving-mean-variance-optimization">Improving Mean Variance Optimization</a></li>
  <li><a href="#best-practices-for-practical-implementation" id="toc-best-practices-for-practical-implementation" class="nav-link" data-scroll-target="#best-practices-for-practical-implementation">Best Practices for Practical Implementation</a>
  <ul class="collapse">
  <li><a href="#robust-parameter-estimation" id="toc-robust-parameter-estimation" class="nav-link" data-scroll-target="#robust-parameter-estimation">1. <strong>Robust Parameter Estimation</strong></a></li>
  <li><a href="#portfolio-rebalancing-strategy" id="toc-portfolio-rebalancing-strategy" class="nav-link" data-scroll-target="#portfolio-rebalancing-strategy">2. <strong>Portfolio Rebalancing Strategy</strong></a></li>
  <li><a href="#risk-management-and-stress-testing" id="toc-risk-management-and-stress-testing" class="nav-link" data-scroll-target="#risk-management-and-stress-testing">3. <strong>Risk Management and Stress Testing</strong></a></li>
  <li><a href="#implementation-considerations" id="toc-implementation-considerations" class="nav-link" data-scroll-target="#implementation-considerations">4. <strong>Implementation Considerations</strong></a></li>
  <li><a href="#institutional-and-regulatory-constraints" id="toc-institutional-and-regulatory-constraints" class="nav-link" data-scroll-target="#institutional-and-regulatory-constraints">5. <strong>Institutional and Regulatory Constraints</strong></a></li>
  </ul></li>
  <li><a href="#summary-and-conclusions" id="toc-summary-and-conclusions" class="nav-link" data-scroll-target="#summary-and-conclusions">Summary and Conclusions</a></li>
  <li><a href="#references-and-further-reading" id="toc-references-and-further-reading" class="nav-link" data-scroll-target="#references-and-further-reading">References and Further Reading</a>
  <ul class="collapse">
  <li><a href="#foundational-academic-literature" id="toc-foundational-academic-literature" class="nav-link" data-scroll-target="#foundational-academic-literature">Foundational Academic Literature</a></li>
  <li><a href="#advanced-theoretical-developments" id="toc-advanced-theoretical-developments" class="nav-link" data-scroll-target="#advanced-theoretical-developments">Advanced Theoretical Developments</a></li>
  <li><a href="#contemporary-research-and-extensions" id="toc-contemporary-research-and-extensions" class="nav-link" data-scroll-target="#contemporary-research-and-extensions">Contemporary Research and Extensions</a></li>
  <li><a href="#textbooks-and-comprehensive-references" id="toc-textbooks-and-comprehensive-references" class="nav-link" data-scroll-target="#textbooks-and-comprehensive-references">Textbooks and Comprehensive References</a></li>
  <li><a href="#computational-resources-for-r" id="toc-computational-resources-for-r" class="nav-link" data-scroll-target="#computational-resources-for-r">Computational Resources for R</a></li>
  <li><a href="#professional-and-institutional-resources" id="toc-professional-and-institutional-resources" class="nav-link" data-scroll-target="#professional-and-institutional-resources">Professional and Institutional Resources</a></li>
  <li><a href="#regulatory-and-industry-standards" id="toc-regulatory-and-industry-standards" class="nav-link" data-scroll-target="#regulatory-and-industry-standards">Regulatory and Industry Standards</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Portfolio Optimization: A Simple Guide to Mean Variance Analysis</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">finance</div>
    <div class="quarto-category">portfolio optimization</div>
    <div class="quarto-category">mean variance</div>
    <div class="quarto-category">risk management</div>
    <div class="quarto-category">R</div>
  </div>
  </div>

<div>
  <div class="description">
    A beginner-friendly guide to portfolio optimization using Mean Variance Analysis in R. Learn how to build optimal portfolios that balance risk and return.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Krishna Kumar Shrestha </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 13, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="portfolio-optimization-a-simple-guide-to-mean-variance-analysis" class="level1">
<h1>Portfolio Optimization: A Simple Guide to Mean Variance Analysis</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What You’ll Learn
</div>
</div>
<div class="callout-body-container callout-body">
<p>This comprehensive guide covers everything about portfolio optimization:</p>
<ul>
<li><strong>Fundamentals:</strong> What is portfolio optimization and why it matters</li>
<li><strong>Theory:</strong> Understanding risk, return, and diversification</li>
<li><strong>Implementation:</strong> Step-by-step R code with real stock data</li>
<li><strong>Practical Examples:</strong> Building optimal portfolios</li>
<li><strong>Limitations:</strong> What to watch out for in real-world applications</li>
</ul>
</div>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Portfolio optimization addresses a fundamental challenge in financial economics: how to allocate capital across multiple assets to achieve optimal risk-return characteristics. The central question involves determining the appropriate weights for each asset in a portfolio to either maximize expected return for a given level of risk or minimize risk for a targeted return level.</p>
<p>The diversification principle suggests that investing in a single asset exposes investors to unnecessary idiosyncratic risk, whereas spreading investments across multiple assets can reduce overall portfolio volatility without proportionally reducing expected returns.</p>
<p>This article examines <strong>Mean Variance Optimization (MVO)</strong>, the foundational framework developed by Harry Markowitz in 1952, which earned him the Nobel Prize in Economic Sciences in 1990. We provide theoretical foundations, mathematical formulations, and practical implementation using R programming language.</p>
</section>
<section id="portfolio-optimization-theoretical-framework" class="level2">
<h2 class="anchored" data-anchor-id="portfolio-optimization-theoretical-framework">Portfolio Optimization: Theoretical Framework</h2>
<p>Portfolio optimization is the systematic process of selecting optimal asset weights to construct portfolios that satisfy specific investment objectives under given constraints. The optimization process seeks to balance the trade-off between expected return and risk through mathematical modeling.</p>
<p><strong>Fundamental Concepts:</strong></p>
<ul>
<li><strong>Portfolio:</strong> A collection of financial assets (securities, bonds, derivatives) held by an investor</li>
<li><strong>Expected Return:</strong> The anticipated return on an investment based on historical data or forward-looking estimates</li>
<li><strong>Risk:</strong> The degree of uncertainty associated with investment returns, typically measured by volatility</li>
<li><strong>Optimization:</strong> The mathematical process of finding optimal asset allocation weights</li>
</ul>
<p>The theoretical foundation rests on the principle that rational investors prefer higher returns for any given level of risk, and lower risk for any given level of expected return. Portfolio construction therefore involves finding combinations that lie on the efficient frontier of this risk-return space.</p>
</section>
<section id="risk-and-return-analysis" class="level2">
<h2 class="anchored" data-anchor-id="risk-and-return-analysis">Risk and Return Analysis</h2>
<p>Understanding the relationship between risk and return forms the cornerstone of modern portfolio theory. These concepts require precise definition and measurement for effective portfolio construction.</p>
<section id="expected-return" class="level3">
<h3 class="anchored" data-anchor-id="expected-return">Expected Return</h3>
<p>Expected return represents the anticipated performance of an asset or portfolio over a specified time horizon. It can be calculated using historical data or forward-looking projections.</p>
<p><strong>Mathematical Definition:</strong> For an asset with historical returns <span class="math inline">\(R_1, R_2, ..., R_T\)</span>, the expected return is: <span class="math display">\[E[R] = \frac{1}{T}\sum_{t=1}^{T} R_t\]</span></p>
<p><strong>Return Classifications:</strong> - <strong>Historical Return:</strong> Calculated from past price movements - <strong>Expected Return:</strong> Forward-looking estimate based on various methodologies</p>
</section>
<section id="risk-measurement" class="level3">
<h3 class="anchored" data-anchor-id="risk-measurement">Risk Measurement</h3>
<p>Risk quantifies the uncertainty surrounding investment outcomes, typically measured through volatility metrics.</p>
<p><strong>Volatility (Standard Deviation):</strong> <span class="math display">\[\sigma = \sqrt{\frac{1}{T-1}\sum_{t=1}^{T}(R_t - E[R])^2}\]</span></p>
<p><strong>Risk Categories:</strong> - <strong>Systematic Risk:</strong> Market-wide risk that cannot be diversified away - <strong>Unsystematic Risk:</strong> Asset-specific risk that can be reduced through diversification</p>
</section>
<section id="the-risk-return-trade-off" class="level3">
<h3 class="anchored" data-anchor-id="the-risk-return-trade-off">The Risk-Return Trade-off</h3>
<p>Financial theory establishes that higher expected returns generally require accepting higher levels of risk. This fundamental relationship drives portfolio optimization decisions and forms the basis for asset pricing models.</p>
</section>
</section>
<section id="mean-variance-optimization-framework" class="level2">
<h2 class="anchored" data-anchor-id="mean-variance-optimization-framework">Mean Variance Optimization Framework</h2>
<p>Mean Variance Optimization (MVO) provides a mathematical framework for constructing portfolios that optimize the risk-return trade-off. The methodology considers expected returns, variances, and covariances of assets to determine optimal allocation weights.</p>
<p><strong>Mathematical Formulation:</strong></p>
<p>For a portfolio with weights <span class="math inline">\(w = (w_1, w_2, ..., w_n)\)</span> and expected returns <span class="math inline">\(\mu = (\mu_1, \mu_2, ..., \mu_n)\)</span>:</p>
<ul>
<li><strong>Portfolio Expected Return:</strong> <span class="math inline">\(E[R_p] = w^T\mu\)</span></li>
<li><strong>Portfolio Variance:</strong> <span class="math inline">\(\sigma_p^2 = w^T\Sigma w\)</span></li>
<li><strong>Portfolio Standard Deviation:</strong> <span class="math inline">\(\sigma_p = \sqrt{w^T\Sigma w}\)</span></li>
</ul>
<p>Where <span class="math inline">\(\Sigma\)</span> represents the covariance matrix of asset returns.</p>
<p><strong>Optimization Objectives:</strong></p>
<ol type="1">
<li><strong>Risk Minimization:</strong> Minimize <span class="math inline">\(\sigma_p^2\)</span> subject to <span class="math inline">\(w^T\mu = \mu_p\)</span> (target return)</li>
<li><strong>Return Maximization:</strong> Maximize <span class="math inline">\(w^T\mu\)</span> subject to <span class="math inline">\(w^T\Sigma w = \sigma_p^2\)</span> (target risk)</li>
<li><strong>Utility Maximization:</strong> Maximize <span class="math inline">\(w^T\mu - \frac{\gamma}{2}w^T\Sigma w\)</span> (risk-adjusted return)</li>
</ol>
<p><strong>The Efficient Frontier:</strong></p>
<p>The efficient frontier represents the set of portfolios that offer the highest expected return for each level of risk, or equivalently, the lowest risk for each level of expected return. Mathematically, it forms the upper boundary of the feasible risk-return space.</p>
</section>
<section id="theoretical-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="theoretical-assumptions">Theoretical Assumptions</h2>
<p>Mean Variance Optimization operates under several key assumptions that define its scope of applicability and limitations:</p>
<section id="rational-investor-behavior" class="level3">
<h3 class="anchored" data-anchor-id="rational-investor-behavior">1. Rational Investor Behavior</h3>
<p><strong>Assumption:</strong> Investors exhibit risk-averse preferences and seek to maximize expected utility. <strong>Implication:</strong> Investors require higher expected returns to compensate for additional risk.</p>
</section>
<section id="normal-distribution-of-returns" class="level3">
<h3 class="anchored" data-anchor-id="normal-distribution-of-returns">2. Normal Distribution of Returns</h3>
<p><strong>Assumption:</strong> Asset returns follow a multivariate normal distribution. <strong>Implication:</strong> Portfolio returns are completely characterized by mean and variance parameters.</p>
</section>
<section id="mean-variance-preferences" class="level3">
<h3 class="anchored" data-anchor-id="mean-variance-preferences">3. Mean-Variance Preferences</h3>
<p><strong>Assumption:</strong> Investor utility functions depend solely on portfolio mean and variance. <strong>Implication:</strong> Higher-order moments (skewness, kurtosis) are not considered in optimization.</p>
</section>
<section id="single-period-framework" class="level3">
<h3 class="anchored" data-anchor-id="single-period-framework">4. Single-Period Framework</h3>
<p><strong>Assumption:</strong> Portfolio optimization occurs over a single investment horizon. <strong>Implication:</strong> Dynamic rebalancing and multi-period considerations are excluded.</p>
</section>
<section id="frictionless-markets" class="level3">
<h3 class="anchored" data-anchor-id="frictionless-markets">5. Frictionless Markets</h3>
<p><strong>Assumption:</strong> Markets operate without transaction costs, taxes, or liquidity constraints. <strong>Implication:</strong> Continuous rebalancing is costless and feasible.</p>
</section>
<section id="homogeneous-expectations" class="level3">
<h3 class="anchored" data-anchor-id="homogeneous-expectations">6. Homogeneous Expectations</h3>
<p><strong>Assumption:</strong> All investors share identical beliefs about asset return distributions. <strong>Implication:</strong> Market equilibrium can be characterized by a single efficient frontier.</p>
</section>
</section>
<section id="empirical-implementation" class="level2">
<h2 class="anchored" data-anchor-id="empirical-implementation">Empirical Implementation</h2>
<p>This section demonstrates the practical application of Mean Variance Optimization using real financial data. We employ R programming to implement the theoretical framework and construct optimal portfolios.</p>
<section id="environment-configuration" class="level3">
<h3 class="anchored" data-anchor-id="environment-configuration">1. Environment Configuration</h3>
<p>The implementation requires several specialized R packages for financial data analysis and optimization procedures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries for financial analysis</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)      <span class="co"># Financial data acquisition and manipulation</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PerformanceAnalytics)  <span class="co"># Portfolio performance analytics</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quadprog)      <span class="co"># Quadratic programming optimization</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)     <span class="co"># Data manipulation and visualization</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)         <span class="co"># Dynamic report generation</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)        <span class="co"># Interactive data visualization</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure global options for numerical precision</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">4</span>, <span class="at">scipen =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-acquisition-and-preprocessing" class="level3">
<h3 class="anchored" data-anchor-id="data-acquisition-and-preprocessing">2. Data Acquisition and Preprocessing</h3>
<p>We construct a diversified portfolio using equity securities from different economic sectors to demonstrate the principles of diversification and correlation effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define asset universe: diversified equity portfolio</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tickers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"AAPL"</span>, <span class="st">"GOOGL"</span>, <span class="st">"JNJ"</span>, <span class="st">"JPM"</span>, <span class="st">"XOM"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>company_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Apple Inc."</span>, <span class="st">"Alphabet Inc."</span>, <span class="st">"Johnson &amp; Johnson"</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"JPMorgan Chase &amp; Co."</span>, <span class="st">"Exxon Mobil Corporation"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define analysis period: 5-year historical window</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>analysis_start <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>() <span class="sc">-</span> <span class="dv">365</span><span class="sc">*</span><span class="dv">5</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>analysis_end <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve adjusted closing prices from Yahoo Finance</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>price_data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(tickers)) {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  price_data[[tickers[i]]] <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(tickers[i], </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">src =</span> <span class="st">"yahoo"</span>, </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">from =</span> analysis_start, </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">to =</span> analysis_end, </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract adjusted closing prices and construct price matrix</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>prices <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">index</span>(price_data[[<span class="dv">1</span>]]))</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(tickers)) {</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  prices[tickers[i]] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">Ad</span>(price_data[[tickers[i]]]))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Display data summary</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(prices) <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Sample of Historical Price Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Sample of Historical Price Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;">date</th>
<th style="text-align: right;">AAPL</th>
<th style="text-align: right;">GOOGL</th>
<th style="text-align: right;">JNJ</th>
<th style="text-align: right;">JPM</th>
<th style="text-align: right;">XOM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2020-07-14</td>
<td style="text-align: right;">94.35</td>
<td style="text-align: right;">75.59</td>
<td style="text-align: right;">128.3</td>
<td style="text-align: right;">85.88</td>
<td style="text-align: right;">35.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">2020-07-15</td>
<td style="text-align: right;">95.00</td>
<td style="text-align: right;">75.39</td>
<td style="text-align: right;">128.6</td>
<td style="text-align: right;">87.21</td>
<td style="text-align: right;">35.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2020-07-16</td>
<td style="text-align: right;">93.83</td>
<td style="text-align: right;">75.29</td>
<td style="text-align: right;">129.5</td>
<td style="text-align: right;">87.45</td>
<td style="text-align: right;">35.28</td>
</tr>
<tr class="even">
<td style="text-align: left;">2020-07-17</td>
<td style="text-align: right;">93.64</td>
<td style="text-align: right;">75.39</td>
<td style="text-align: right;">129.6</td>
<td style="text-align: right;">85.83</td>
<td style="text-align: right;">34.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2020-07-20</td>
<td style="text-align: right;">95.61</td>
<td style="text-align: right;">77.73</td>
<td style="text-align: right;">129.8</td>
<td style="text-align: right;">85.08</td>
<td style="text-align: right;">33.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">2020-07-21</td>
<td style="text-align: right;">94.29</td>
<td style="text-align: right;">77.33</td>
<td style="text-align: right;">129.9</td>
<td style="text-align: right;">86.93</td>
<td style="text-align: right;">35.58</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset characteristics</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Analysis Period:"</span>, <span class="fu">format</span>(<span class="fu">min</span>(prices<span class="sc">$</span>date), <span class="st">"%Y-%m-%d"</span>), <span class="st">"to"</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(<span class="fu">max</span>(prices<span class="sc">$</span>date), <span class="st">"%Y-%m-%d"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis Period: 2020-07-14 to 2025-07-11 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total Observations:"</span>, <span class="fu">nrow</span>(prices), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total Observations: 1255 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Assets in Universe:"</span>, <span class="fu">length</span>(tickers), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Assets in Universe: 5 </code></pre>
</div>
</div>
</section>
<section id="return-calculation-and-statistical-analysis" class="level3">
<h3 class="anchored" data-anchor-id="return-calculation-and-statistical-analysis">3. Return Calculation and Statistical Analysis</h3>
<p>Portfolio optimization requires return data rather than price levels. We calculate logarithmic returns and compute relevant statistical measures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate logarithmic returns</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>returns <span class="ot">&lt;-</span> prices <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>date) <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(<span class="fu">log</span>(.))))) <span class="sc">|&gt;</span>  <span class="co"># Log returns</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to matrix format for mathematical operations</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>returns_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(returns)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute descriptive statistics (annualized)</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>descriptive_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Asset =</span> company_names,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ticker =</span> tickers,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean_Return =</span> <span class="fu">round</span>(<span class="fu">colMeans</span>(returns) <span class="sc">*</span> <span class="dv">252</span>, <span class="dv">4</span>),  <span class="co"># Annualized mean</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Volatility =</span> <span class="fu">round</span>(<span class="fu">apply</span>(returns, <span class="dv">2</span>, sd) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">252</span>), <span class="dv">4</span>),  <span class="co"># Annualized volatility</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Minimum =</span> <span class="fu">round</span>(<span class="fu">apply</span>(returns, <span class="dv">2</span>, min), <span class="dv">4</span>),       <span class="co"># Minimum daily return</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Maximum =</span> <span class="fu">round</span>(<span class="fu">apply</span>(returns, <span class="dv">2</span>, max), <span class="dv">4</span>)        <span class="co"># Maximum daily return</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(descriptive_stats, </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Asset Return Statistics (Annualized Measures)"</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Company"</span>, <span class="st">"Ticker"</span>, <span class="st">"Mean Return"</span>, <span class="st">"Volatility"</span>, </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Min Return"</span>, <span class="st">"Max Return"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Asset Return Statistics (Annualized Measures)</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 29%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Company</th>
<th style="text-align: left;">Ticker</th>
<th style="text-align: right;">Mean Return</th>
<th style="text-align: right;">Volatility</th>
<th style="text-align: right;">Min Return</th>
<th style="text-align: right;">Max Return</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AAPL</td>
<td style="text-align: left;">Apple Inc.</td>
<td style="text-align: left;">AAPL</td>
<td style="text-align: right;">0.1619</td>
<td style="text-align: right;">0.2975</td>
<td style="text-align: right;">-0.0970</td>
<td style="text-align: right;">0.1426</td>
</tr>
<tr class="even">
<td style="text-align: left;">GOOGL</td>
<td style="text-align: left;">Alphabet Inc.</td>
<td style="text-align: left;">GOOGL</td>
<td style="text-align: right;">0.1746</td>
<td style="text-align: right;">0.3107</td>
<td style="text-align: right;">-0.0999</td>
<td style="text-align: right;">0.0973</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JNJ</td>
<td style="text-align: left;">Johnson &amp; Johnson</td>
<td style="text-align: left;">JNJ</td>
<td style="text-align: right;">0.0404</td>
<td style="text-align: right;">0.1668</td>
<td style="text-align: right;">-0.0790</td>
<td style="text-align: right;">0.0590</td>
</tr>
<tr class="even">
<td style="text-align: left;">JPM</td>
<td style="text-align: left;">JPMorgan Chase &amp; Co.</td>
<td style="text-align: left;">JPM</td>
<td style="text-align: right;">0.2424</td>
<td style="text-align: right;">0.2553</td>
<td style="text-align: right;">-0.0778</td>
<td style="text-align: right;">0.1270</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XOM</td>
<td style="text-align: left;">Exxon Mobil Corporation</td>
<td style="text-align: left;">XOM</td>
<td style="text-align: right;">0.2391</td>
<td style="text-align: right;">0.2926</td>
<td style="text-align: right;">-0.0821</td>
<td style="text-align: right;">0.1192</td>
</tr>
</tbody>
</table>
<p>Time series of daily returns for selected assets</p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize return time series</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>returns_long <span class="ot">&lt;-</span> returns <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> prices<span class="sc">$</span>date[<span class="sc">-</span><span class="dv">1</span>]) <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>date, <span class="at">names_to =</span> <span class="st">"asset"</span>, <span class="at">values_to =</span> <span class="st">"return"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(returns_long, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> return, <span class="at">color =</span> asset)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>asset, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Daily Return Time Series by Asset"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"5-Year Analysis Period"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Daily Return"</span>) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="portfolio-optimization-mean-variance_files/figure-html/calculate-returns-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Time series of daily returns for selected assets</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="correlation-structure-analysis" class="level3">
<h3 class="anchored" data-anchor-id="correlation-structure-analysis">4. Correlation Structure Analysis</h3>
<p>Correlation analysis reveals the degree of linear dependence between asset returns, which directly impacts diversification benefits and optimal portfolio weights.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute empirical correlation matrix</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(returns)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Format correlation matrix for presentation</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>correlation_display <span class="ot">&lt;-</span> correlation_matrix</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(correlation_display) <span class="ot">&lt;-</span> company_names</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(correlation_display) <span class="ot">&lt;-</span> company_names</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlation_display, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Pairwise Correlation Matrix of Asset Returns"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Pairwise Correlation Matrix of Asset Returns</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Apple Inc.</th>
<th style="text-align: right;">Alphabet Inc.</th>
<th style="text-align: right;">Johnson &amp; Johnson</th>
<th style="text-align: right;">JPMorgan Chase &amp; Co.</th>
<th style="text-align: right;">Exxon Mobil Corporation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Apple Inc.</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.573</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.303</td>
<td style="text-align: right;">0.170</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alphabet Inc.</td>
<td style="text-align: right;">0.573</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">0.308</td>
<td style="text-align: right;">0.133</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Johnson &amp; Johnson</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">0.165</td>
</tr>
<tr class="even">
<td style="text-align: left;">JPMorgan Chase &amp; Co.</td>
<td style="text-align: right;">0.303</td>
<td style="text-align: right;">0.308</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.428</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exxon Mobil Corporation</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.133</td>
<td style="text-align: right;">0.165</td>
<td style="text-align: right;">0.428</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
<p>Asset correlation matrix and heatmap visualization</p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for correlation heatmap</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>correlation_long <span class="ot">&lt;-</span> correlation_matrix <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"asset1"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>asset1, <span class="at">names_to =</span> <span class="st">"asset2"</span>, <span class="at">values_to =</span> <span class="st">"correlation"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">asset1 =</span> <span class="fu">factor</span>(asset1, <span class="at">levels =</span> tickers, <span class="at">labels =</span> company_names),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">asset2 =</span> <span class="fu">factor</span>(asset2, <span class="at">levels =</span> tickers, <span class="at">labels =</span> company_names)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate correlation heatmap</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(correlation_long, <span class="fu">aes</span>(<span class="at">x =</span> asset1, <span class="at">y =</span> asset2, <span class="at">fill =</span> correlation)) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>, </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Asset Return Correlation Matrix"</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Heatmap Visualization"</span>,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Asset"</span>, <span class="at">y =</span> <span class="st">"Asset"</span>, <span class="at">fill =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="portfolio-optimization-mean-variance_files/figure-html/correlations-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Asset correlation matrix and heatmap visualization</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and display diversification metrics</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>mean_correlation <span class="ot">&lt;-</span> <span class="fu">mean</span>(correlation_matrix[<span class="fu">upper.tri</span>(correlation_matrix)])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>max_correlation <span class="ot">&lt;-</span> <span class="fu">max</span>(correlation_matrix[<span class="fu">upper.tri</span>(correlation_matrix)])</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>min_correlation <span class="ot">&lt;-</span> <span class="fu">min</span>(correlation_matrix[<span class="fu">upper.tri</span>(correlation_matrix)])</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation Analysis Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation Analysis Summary:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean Pairwise Correlation:"</span>, <span class="fu">round</span>(mean_correlation, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Pairwise Correlation: 0.258 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Maximum Correlation:"</span>, <span class="fu">round</span>(max_correlation, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum Correlation: 0.573 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Minimum Correlation:"</span>, <span class="fu">round</span>(min_correlation, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimum Correlation: 0.097 </code></pre>
</div>
</div>
</section>
<section id="optimization-algorithm-implementation" class="level3">
<h3 class="anchored" data-anchor-id="optimization-algorithm-implementation">5. Optimization Algorithm Implementation</h3>
<p>We implement the quadratic programming solution to the mean-variance optimization problem using the standard mathematical formulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate optimization inputs</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(returns) <span class="sc">*</span> <span class="dv">252</span>    <span class="co"># Annualized expected returns vector</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(returns) <span class="sc">*</span> <span class="dv">252</span>      <span class="co"># Annualized covariance matrix</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>n_assets <span class="ot">&lt;-</span> <span class="fu">length</span>(mu)           <span class="co"># Number of assets in universe</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define portfolio optimization function</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>optimize_portfolio <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">target_return =</span> <span class="cn">NULL</span>, <span class="at">risk_aversion =</span> <span class="cn">NULL</span>) {</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Constraint matrices: weights sum to 1, non-negativity constraints</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  A_equality <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n_assets), <span class="at">nrow =</span> <span class="dv">1</span>)  <span class="co"># Budget constraint</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  A_inequality <span class="ot">&lt;-</span> <span class="fu">diag</span>(n_assets)                     <span class="co"># Non-negativity constraints</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  Amat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A_equality, A_inequality)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  bvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>, n_assets))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(target_return)) {</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Minimize variance subject to target return constraint</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    A_return <span class="ot">&lt;-</span> <span class="fu">matrix</span>(mu, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    Amat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A_return, Amat)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    bvec <span class="ot">&lt;-</span> <span class="fu">c</span>(target_return, bvec)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Solve quadratic programming problem: min(1/2 * w'Qw) s.t. Aw &gt;= b</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    solution <span class="ot">&lt;-</span> <span class="fu">solve.QP</span>(<span class="at">Dmat =</span> <span class="dv">2</span><span class="sc">*</span>Sigma, <span class="at">dvec =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_assets), </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Amat =</span> <span class="fu">t</span>(Amat), <span class="at">bvec =</span> bvec, <span class="at">meq =</span> <span class="dv">2</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(risk_aversion)) {</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Maximize utility: E[r] - (γ/2)σ²</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    dvec <span class="ot">&lt;-</span> mu</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    solution <span class="ot">&lt;-</span> <span class="fu">solve.QP</span>(<span class="at">Dmat =</span> risk_aversion <span class="sc">*</span> Sigma, <span class="at">dvec =</span> dvec, </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Amat =</span> <span class="fu">t</span>(Amat), <span class="at">bvec =</span> bvec, <span class="at">meq =</span> <span class="dv">1</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract optimal weights</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> solution<span class="sc">$</span>solution</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(weights) <span class="ot">&lt;-</span> tickers</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate portfolio performance metrics</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  portfolio_return <span class="ot">&lt;-</span> <span class="fu">sum</span>(weights <span class="sc">*</span> mu)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  portfolio_variance <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">t</span>(weights) <span class="sc">%*%</span> Sigma <span class="sc">%*%</span> weights)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  portfolio_volatility <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(portfolio_variance)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  sharpe_ratio <span class="ot">&lt;-</span> portfolio_return <span class="sc">/</span> portfolio_volatility</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> weights,</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">expected_return =</span> portfolio_return,</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">volatility =</span> portfolio_volatility,</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">sharpe_ratio =</span> sharpe_ratio,</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">variance =</span> portfolio_variance</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Portfolio optimization algorithm successfully implemented.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Portfolio optimization algorithm successfully implemented.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Available optimization modes: target return, risk aversion parameter.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Available optimization modes: target return, risk aversion parameter.</code></pre>
</div>
</div>
</section>
<section id="finding-optimal-portfolios" class="level3">
<h3 class="anchored" data-anchor-id="finding-optimal-portfolios">6. Finding Optimal Portfolios</h3>
<p>Let’s find some interesting portfolios: minimum risk, maximum Sharpe ratio, and equal weight.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Minimum Risk Portfolio</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>min_risk_port <span class="ot">&lt;-</span> <span class="fu">optimize_portfolio</span>(<span class="at">target_return =</span> <span class="fu">min</span>(mu))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Maximum Return Portfolio (single asset)</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>max_return_idx <span class="ot">&lt;-</span> <span class="fu">which.max</span>(mu)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>max_return_port <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_assets),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">expected_return =</span> mu[max_return_idx],</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">volatility =</span> <span class="fu">sqrt</span>(Sigma[max_return_idx, max_return_idx])</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>max_return_port<span class="sc">$</span>weights[max_return_idx] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(max_return_port<span class="sc">$</span>weights) <span class="ot">&lt;-</span> tickers</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>max_return_port<span class="sc">$</span>sharpe_ratio <span class="ot">&lt;-</span> max_return_port<span class="sc">$</span>expected_return <span class="sc">/</span> max_return_port<span class="sc">$</span>volatility</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Equal Weight Portfolio</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>equal_weight_port <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n_assets, n_assets),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">expected_return =</span> <span class="fu">sum</span>(mu<span class="sc">/</span>n_assets),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">volatility =</span> <span class="fu">sqrt</span>(<span class="fu">t</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n_assets, n_assets)) <span class="sc">%*%</span> Sigma <span class="sc">%*%</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n_assets, n_assets))</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(equal_weight_port<span class="sc">$</span>weights) <span class="ot">&lt;-</span> tickers</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>equal_weight_port<span class="sc">$</span>sharpe_ratio <span class="ot">&lt;-</span> equal_weight_port<span class="sc">$</span>expected_return <span class="sc">/</span> <span class="fu">as.numeric</span>(equal_weight_port<span class="sc">$</span>volatility)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>portfolio_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">Portfolio =</span> <span class="fu">c</span>(<span class="st">"Minimum Risk"</span>, <span class="st">"Maximum Return"</span>, <span class="st">"Equal Weight"</span>),</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Expected_Return =</span> <span class="fu">c</span>(min_risk_port<span class="sc">$</span>expected_return, max_return_port<span class="sc">$</span>expected_return, equal_weight_port<span class="sc">$</span>expected_return),</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Risk =</span> <span class="fu">c</span>(min_risk_port<span class="sc">$</span>volatility, max_return_port<span class="sc">$</span>volatility, <span class="fu">as.numeric</span>(equal_weight_port<span class="sc">$</span>volatility)),</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sharpe_Ratio =</span> <span class="fu">c</span>(min_risk_port<span class="sc">$</span>sharpe_ratio, max_return_port<span class="sc">$</span>sharpe_ratio, equal_weight_port<span class="sc">$</span>sharpe_ratio)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(portfolio_comparison, </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Comparison of Different Portfolio Strategies"</span>,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparison of Different Portfolio Strategies</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Portfolio</th>
<th style="text-align: right;">Expected_Return</th>
<th style="text-align: right;">Risk</th>
<th style="text-align: right;">Sharpe_Ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Minimum Risk</td>
<td style="text-align: right;">0.0404</td>
<td style="text-align: right;">0.1668</td>
<td style="text-align: right;">0.2420</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maximum Return</td>
<td style="text-align: right;">0.2424</td>
<td style="text-align: right;">0.2553</td>
<td style="text-align: right;">0.9495</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Equal Weight</td>
<td style="text-align: right;">0.1717</td>
<td style="text-align: right;">0.1727</td>
<td style="text-align: right;">0.9941</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show portfolio weights</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>weights_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Stock =</span> company_names,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min_Risk =</span> <span class="fu">round</span>(min_risk_port<span class="sc">$</span>weights, <span class="dv">3</span>),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_Return =</span> <span class="fu">round</span>(max_return_port<span class="sc">$</span>weights, <span class="dv">3</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Equal_Weight =</span> <span class="fu">round</span>(equal_weight_port<span class="sc">$</span>weights, <span class="dv">3</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(weights_comparison, </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Portfolio Weights for Different Strategies"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Portfolio Weights for Different Strategies</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Stock</th>
<th style="text-align: right;">Min_Risk</th>
<th style="text-align: right;">Max_Return</th>
<th style="text-align: right;">Equal_Weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AAPL</td>
<td style="text-align: left;">Apple Inc.</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">GOOGL</td>
<td style="text-align: left;">Alphabet Inc.</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JNJ</td>
<td style="text-align: left;">Johnson &amp; Johnson</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">JPM</td>
<td style="text-align: left;">JPMorgan Chase &amp; Co.</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XOM</td>
<td style="text-align: left;">Exxon Mobil Corporation</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="creating-the-efficient-frontier" class="level3">
<h3 class="anchored" data-anchor-id="creating-the-efficient-frontier">7. Creating the Efficient Frontier</h3>
<p>The efficient frontier shows all optimal portfolios with different risk-return combinations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate efficient frontier</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>target_returns <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(mu), <span class="fu">max</span>(mu), <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>efficient_portfolios <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(target_returns)) {</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    port <span class="ot">&lt;-</span> <span class="fu">optimize_portfolio</span>(<span class="at">target_return =</span> target_returns[i])</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    efficient_portfolios[[i]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">return =</span> port<span class="sc">$</span>expected_return,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">risk =</span> port<span class="sc">$</span>volatility,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">sharpe =</span> port<span class="sc">$</span>sharpe_ratio</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    efficient_portfolios[[i]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine results</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>efficient_frontier_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, efficient_portfolios)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot efficient frontier</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> efficient_frontier_data, </span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> risk, <span class="at">y =</span> return), </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> min_risk_port<span class="sc">$</span>volatility, <span class="at">y =</span> min_risk_port<span class="sc">$</span>expected_return), </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(equal_weight_port<span class="sc">$</span>volatility), <span class="at">y =</span> equal_weight_port<span class="sc">$</span>expected_return), </span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> max_return_port<span class="sc">$</span>volatility, <span class="at">y =</span> max_return_port<span class="sc">$</span>expected_return), </span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efficient Frontier"</span>,</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Green = Min Risk, Orange = Equal Weight, Red = Max Return"</span>,</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Risk (Standard Deviation)"</span>,</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Expected Return"</span>) <span class="sc">+</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="portfolio-optimization-mean-variance_files/figure-html/efficient-frontier-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Efficient Frontier showing optimal risk-return combinations</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add individual stock points</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>individual_stocks <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stock =</span> company_names,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">return =</span> mu,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(Sigma))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> p3 <span class="sc">+</span> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> individual_stocks, </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> risk, <span class="at">y =</span> return), </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> individual_stocks, </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> risk, <span class="at">y =</span> return, <span class="at">label =</span> stock), </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="portfolio-optimization-mean-variance_files/figure-html/efficient-frontier-2.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Efficient Frontier showing optimal risk-return combinations</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="practical-example-building-your-portfolio" class="level2">
<h2 class="anchored" data-anchor-id="practical-example-building-your-portfolio">Practical Example: Building Your Portfolio</h2>
<p>Let’s say you want to invest $10,000 with moderate risk tolerance. Here’s how to determine your optimal portfolio:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's find a portfolio with moderate risk (between min and max)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>target_risk <span class="ot">&lt;-</span> <span class="fl">0.15</span>  <span class="co"># 15% annual volatility</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find portfolio closest to target risk</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>risk_differences <span class="ot">&lt;-</span> <span class="fu">abs</span>(efficient_frontier_data<span class="sc">$</span>risk <span class="sc">-</span> target_risk)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>best_idx <span class="ot">&lt;-</span> <span class="fu">which.min</span>(risk_differences)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>moderate_target_return <span class="ot">&lt;-</span> efficient_frontier_data<span class="sc">$</span>return[best_idx]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>moderate_portfolio <span class="ot">&lt;-</span> <span class="fu">optimize_portfolio</span>(<span class="at">target_return =</span> moderate_target_return)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate dollar amounts for $10,000 investment</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>investment_amount <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>dollar_allocation <span class="ot">&lt;-</span> moderate_portfolio<span class="sc">$</span>weights <span class="sc">*</span> investment_amount</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>allocation_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Company =</span> company_names,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Symbol =</span> tickers,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weight =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(moderate_portfolio<span class="sc">$</span>weights <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>),</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dollar_Amount =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">round</span>(dollar_allocation, <span class="dv">0</span>))</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(allocation_table, </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Your Optimal Portfolio Allocation ($10,000 Investment)"</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Company"</span>, <span class="st">"Symbol"</span>, <span class="st">"Weight"</span>, <span class="st">"Dollar Amount"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Your Optimal Portfolio Allocation ($10,000 Investment)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Company</th>
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Weight</th>
<th style="text-align: left;">Dollar Amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Apple Inc.</td>
<td style="text-align: left;">AAPL</td>
<td style="text-align: left;">7.1%</td>
<td style="text-align: left;">$706</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alphabet Inc.</td>
<td style="text-align: left;">GOOGL</td>
<td style="text-align: left;">11.5%</td>
<td style="text-align: left;">$1146</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Johnson &amp; Johnson</td>
<td style="text-align: left;">JNJ</td>
<td style="text-align: left;">42%</td>
<td style="text-align: left;">$4203</td>
</tr>
<tr class="even">
<td style="text-align: left;">JPMorgan Chase &amp; Co.</td>
<td style="text-align: left;">JPM</td>
<td style="text-align: left;">21.4%</td>
<td style="text-align: left;">$2144</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exxon Mobil Corporation</td>
<td style="text-align: left;">XOM</td>
<td style="text-align: left;">18%</td>
<td style="text-align: left;">$1800</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Portfolio Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Portfolio Statistics:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected Annual Return:"</span>, <span class="fu">round</span>(moderate_portfolio<span class="sc">$</span>expected_return <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expected Annual Return: 14.34 %</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected Annual Risk:"</span>, <span class="fu">round</span>(moderate_portfolio<span class="sc">$</span>volatility <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expected Annual Risk: 15 %</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sharpe Ratio:"</span>, <span class="fu">round</span>(moderate_portfolio<span class="sc">$</span>sharpe_ratio, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharpe Ratio: 0.956 </code></pre>
</div>
</div>
</section>
<section id="advantages-of-mean-variance-optimization" class="level2">
<h2 class="anchored" data-anchor-id="advantages-of-mean-variance-optimization">Advantages of Mean Variance Optimization</h2>
<p>Mean Variance Optimization offers several significant advantages that have established it as the foundation of modern portfolio theory:</p>
<section id="mathematical-rigor-and-theoretical-foundation" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-rigor-and-theoretical-foundation">1. <strong>Mathematical Rigor and Theoretical Foundation</strong></h3>
<ul>
<li>Provides a mathematically sound framework for portfolio construction</li>
<li>Based on axiomatic utility theory and rational choice principles</li>
<li>Offers closed-form solutions through quadratic programming</li>
<li>Recognized with the 1990 Nobel Prize in Economic Sciences</li>
</ul>
</section>
<section id="systematic-risk-management" class="level3">
<h3 class="anchored" data-anchor-id="systematic-risk-management">2. <strong>Systematic Risk Management</strong></h3>
<ul>
<li>Explicitly incorporates correlation structures between assets</li>
<li>Quantifies diversification benefits through mathematical optimization</li>
<li>Provides optimal trade-off between risk and expected return</li>
<li>Enables precise measurement of portfolio risk characteristics</li>
</ul>
</section>
<section id="flexibility-and-customization" class="level3">
<h3 class="anchored" data-anchor-id="flexibility-and-customization">3. <strong>Flexibility and Customization</strong></h3>
<ul>
<li>Accommodates various investor preferences through utility functions</li>
<li>Supports multiple optimization objectives (risk minimization, return maximization)</li>
<li>Allows incorporation of investment constraints and preferences</li>
<li>Scalable to portfolios of any size or complexity</li>
</ul>
</section>
<section id="empirical-and-practical-applications" class="level3">
<h3 class="anchored" data-anchor-id="empirical-and-practical-applications">4. <strong>Empirical and Practical Applications</strong></h3>
<ul>
<li>Serves as foundation for Capital Asset Pricing Model (CAPM)</li>
<li>Enables construction of efficient frontiers for investment analysis</li>
<li>Provides benchmark for portfolio performance evaluation</li>
<li>Supports asset allocation decisions across institutional and retail contexts</li>
</ul>
</section>
</section>
<section id="limitations-and-critical-assessment" class="level2">
<h2 class="anchored" data-anchor-id="limitations-and-critical-assessment">Limitations and Critical Assessment</h2>
<p>Despite its theoretical elegance and practical utility, Mean Variance Optimization faces several important limitations that affect its real-world application:</p>
<section id="parameter-estimation-risk" class="level3">
<h3 class="anchored" data-anchor-id="parameter-estimation-risk">1. <strong>Parameter Estimation Risk</strong></h3>
<p><strong>Problem:</strong> Optimal portfolios are highly sensitive to input parameters (expected returns, volatilities, correlations). <strong>Academic Evidence:</strong> Small estimation errors can lead to substantially different portfolio compositions. <strong>Mitigation Strategies:</strong> Robust optimization techniques, Bayesian approaches, confidence intervals around estimates.</p>
</section>
<section id="input-sensitivity-and-instability" class="level3">
<h3 class="anchored" data-anchor-id="input-sensitivity-and-instability">2. <strong>Input Sensitivity and Instability</strong></h3>
<p><strong>Problem:</strong> Minor changes in expected return estimates can result in dramatically different optimal allocations. <strong>Practical Impact:</strong> Portfolio turnover becomes excessive, leading to high transaction costs. <strong>Solutions:</strong> Regularization methods, constrained optimization, resampling techniques.</p>
</section>
<section id="concentration-risk" class="level3">
<h3 class="anchored" data-anchor-id="concentration-risk">3. <strong>Concentration Risk</strong></h3>
<p><strong>Problem:</strong> Unconstrained optimization often produces portfolios with extreme position weights. <strong>Theoretical Basis:</strong> Optimizer exploits small differences in expected returns to generate concentrated positions. <strong>Practical Solutions:</strong> Position limits, diversification constraints, risk budgeting approaches.</p>
</section>
<section id="distributional-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="distributional-assumptions">4. <strong>Distributional Assumptions</strong></h3>
<p><strong>Problem:</strong> Normal distribution assumption fails to capture tail risks and extreme market events. <strong>Empirical Evidence:</strong> Financial returns exhibit fat tails, skewness, and time-varying volatility. <strong>Alternative Approaches:</strong> Conditional Value-at-Risk (CVaR), higher-moment optimization, regime-switching models.</p>
</section>
<section id="single-period-limitation" class="level3">
<h3 class="anchored" data-anchor-id="single-period-limitation">5. <strong>Single-Period Limitation</strong></h3>
<p><strong>Problem:</strong> Framework assumes static single-period investment horizon. <strong>Reality:</strong> Investors face multi-period investment decisions with changing opportunity sets. <strong>Extensions:</strong> Dynamic programming, stochastic control theory, multi-period mean-variance models.</p>
</section>
<section id="market-frictions" class="level3">
<h3 class="anchored" data-anchor-id="market-frictions">6. <strong>Market Frictions</strong></h3>
<p><strong>Problem:</strong> Model ignores transaction costs, taxes, liquidity constraints, and market impact. <strong>Practical Significance:</strong> Trading costs can exceed optimization benefits, particularly for high-turnover strategies. <strong>Implementation Solutions:</strong> Transaction cost models, turnover constraints, liquidity-adjusted optimization.</p>
</section>
</section>
<section id="improving-mean-variance-optimization" class="level2">
<h2 class="anchored" data-anchor-id="improving-mean-variance-optimization">Improving Mean Variance Optimization</h2>
<p>Here are some practical ways to make Mean Variance Optimization more robust:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Add constraints to prevent extreme allocations</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>optimize_portfolio_constrained <span class="ot">&lt;-</span> <span class="cf">function</span>(target_return, <span class="at">min_weight =</span> <span class="fl">0.05</span>, <span class="at">max_weight =</span> <span class="fl">0.4</span>) {</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enhanced constraints</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  Amat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="dv">1</span>, n_assets),           <span class="co"># weights sum to 1</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    mu,                  <span class="co"># target return constraint</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">diag</span>(n_assets),            <span class="co"># weights &gt;= min_weight</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">diag</span>(n_assets)            <span class="co"># weights &lt;= max_weight</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  bvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, target_return, <span class="fu">rep</span>(min_weight, n_assets), <span class="fu">rep</span>(<span class="sc">-</span>max_weight, n_assets))</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">solve.QP</span>(<span class="at">Dmat =</span> <span class="dv">2</span><span class="sc">*</span>Sigma, <span class="at">dvec =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_assets), </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Amat =</span> <span class="fu">t</span>(Amat), <span class="at">bvec =</span> bvec, <span class="at">meq =</span> <span class="dv">2</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> solution<span class="sc">$</span>solution</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(weights) <span class="ot">&lt;-</span> tickers</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  port_return <span class="ot">&lt;-</span> <span class="fu">sum</span>(weights <span class="sc">*</span> mu)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  port_risk <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">t</span>(weights) <span class="sc">%*%</span> Sigma <span class="sc">%*%</span> weights)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> weights,</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">expected_return =</span> port_return,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">volatility =</span> <span class="fu">as.numeric</span>(port_risk),</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">sharpe_ratio =</span> port_return <span class="sc">/</span> <span class="fu">as.numeric</span>(port_risk)</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare constrained vs unconstrained</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>unconstrained <span class="ot">&lt;-</span> <span class="fu">optimize_portfolio</span>(<span class="at">target_return =</span> moderate_target_return)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>constrained <span class="ot">&lt;-</span> <span class="fu">optimize_portfolio_constrained</span>(<span class="at">target_return =</span> moderate_target_return)</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">Approach =</span> <span class="fu">c</span>(<span class="st">"Unconstrained"</span>, <span class="st">"Constrained"</span>),</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">Return =</span> <span class="fu">c</span>(unconstrained<span class="sc">$</span>expected_return, constrained<span class="sc">$</span>expected_return),</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">Risk =</span> <span class="fu">c</span>(unconstrained<span class="sc">$</span>volatility, constrained<span class="sc">$</span>volatility),</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sharpe =</span> <span class="fu">c</span>(unconstrained<span class="sc">$</span>sharpe_ratio, constrained<span class="sc">$</span>sharpe_ratio),</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_Weight =</span> <span class="fu">c</span>(<span class="fu">max</span>(unconstrained<span class="sc">$</span>weights), <span class="fu">max</span>(constrained<span class="sc">$</span>weights)),</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min_Weight =</span> <span class="fu">c</span>(<span class="fu">min</span>(unconstrained<span class="sc">$</span>weights), <span class="fu">min</span>(constrained<span class="sc">$</span>weights))</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison, </span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Comparison: Constrained vs Unconstrained Optimization"</span>,</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparison: Constrained vs Unconstrained Optimization</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Approach</th>
<th style="text-align: right;">Return</th>
<th style="text-align: right;">Risk</th>
<th style="text-align: right;">Sharpe</th>
<th style="text-align: right;">Max_Weight</th>
<th style="text-align: right;">Min_Weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Unconstrained</td>
<td style="text-align: right;">0.1434</td>
<td style="text-align: right;">0.1500</td>
<td style="text-align: right;">0.9564</td>
<td style="text-align: right;">0.4203</td>
<td style="text-align: right;">0.0706</td>
</tr>
<tr class="even">
<td style="text-align: left;">Constrained</td>
<td style="text-align: right;">0.1434</td>
<td style="text-align: right;">0.1507</td>
<td style="text-align: right;">0.9520</td>
<td style="text-align: right;">0.4000</td>
<td style="text-align: right;">0.1092</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="best-practices-for-practical-implementation" class="level2">
<h2 class="anchored" data-anchor-id="best-practices-for-practical-implementation">Best Practices for Practical Implementation</h2>
<section id="robust-parameter-estimation" class="level3">
<h3 class="anchored" data-anchor-id="robust-parameter-estimation">1. <strong>Robust Parameter Estimation</strong></h3>
<ul>
<li>Employ multiple estimation methodologies rather than relying solely on historical averages</li>
<li>Incorporate forward-looking information from analyst forecasts and economic models</li>
<li>Utilize shrinkage estimators and Bayesian approaches to improve parameter stability</li>
<li>Implement Black-Litterman methodology to combine market equilibrium with investor views</li>
</ul>
</section>
<section id="portfolio-rebalancing-strategy" class="level3">
<h3 class="anchored" data-anchor-id="portfolio-rebalancing-strategy">2. <strong>Portfolio Rebalancing Strategy</strong></h3>
<ul>
<li>Establish systematic rebalancing schedules (quarterly, semi-annually) based on institutional constraints</li>
<li>Monitor drift from target allocations and implement threshold-based rebalancing rules</li>
<li>Account for transaction costs and tax implications in rebalancing decisions</li>
<li>Consider regime changes and structural breaks in market conditions</li>
</ul>
</section>
<section id="risk-management-and-stress-testing" class="level3">
<h3 class="anchored" data-anchor-id="risk-management-and-stress-testing">3. <strong>Risk Management and Stress Testing</strong></h3>
<ul>
<li>Conduct scenario analysis and stress testing under extreme market conditions</li>
<li>Implement Monte Carlo simulations to assess portfolio robustness</li>
<li>Evaluate portfolio performance during historical crisis periods</li>
<li>Monitor factor exposures and concentration risks continuously</li>
</ul>
</section>
<section id="implementation-considerations" class="level3">
<h3 class="anchored" data-anchor-id="implementation-considerations">4. <strong>Implementation Considerations</strong></h3>
<ul>
<li>Begin with broad asset class allocation before proceeding to individual security selection</li>
<li>Implement position limits and diversification constraints to prevent excessive concentration</li>
<li>Account for implementation costs including bid-ask spreads, market impact, and custody fees</li>
<li>Consider investment vehicle efficiency (ETFs, index funds) versus direct security holdings</li>
</ul>
</section>
<section id="institutional-and-regulatory-constraints" class="level3">
<h3 class="anchored" data-anchor-id="institutional-and-regulatory-constraints">5. <strong>Institutional and Regulatory Constraints</strong></h3>
<ul>
<li>Incorporate investment policy constraints and regulatory requirements</li>
<li>Consider liability matching for institutional investors (pension funds, insurance companies)</li>
<li>Account for liquidity requirements and redemption patterns</li>
<li>Evaluate ESG (Environmental, Social, Governance) constraints and preferences</li>
</ul>
</section>
</section>
<section id="summary-and-conclusions" class="level2">
<h2 class="anchored" data-anchor-id="summary-and-conclusions">Summary and Conclusions</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Research Findings
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Theoretical Foundation:</strong> Mean Variance Optimization provides a rigorous mathematical framework for portfolio construction based on expected utility maximization</p></li>
<li><p><strong>Empirical Application:</strong> The methodology successfully identifies efficient portfolios that optimize the risk-return trade-off within the constraints of available data</p></li>
<li><p><strong>Diversification Benefits:</strong> Mathematical optimization quantifies and captures correlation-based diversification effects that reduce portfolio risk</p></li>
<li><p><strong>Implementation Challenges:</strong> Parameter sensitivity and estimation risk represent significant practical limitations requiring robust mitigation strategies</p></li>
<li><p><strong>Risk Management Integration:</strong> Optimal portfolio construction must incorporate realistic constraints, transaction costs, and ongoing risk monitoring</p></li>
<li><p><strong>Academic and Practical Relevance:</strong> Despite limitations, MVO remains the foundation for modern portfolio theory and continues to inform institutional investment practices</p></li>
</ol>
</div>
</div>
<p>Mean Variance Optimization represents a fundamental breakthrough in quantitative finance, providing the theoretical foundation for modern portfolio management. While practical implementation requires careful attention to parameter estimation, constraints, and market frictions, the framework continues to serve as the cornerstone of systematic investment management.</p>
<p>The methodology’s enduring influence stems from its mathematical rigor and practical applicability across diverse investment contexts. Students and practitioners should understand both the theoretical elegance and practical limitations of the approach, using it as a starting point for more sophisticated portfolio construction methodologies.</p>
</section>
<section id="references-and-further-reading" class="level2">
<h2 class="anchored" data-anchor-id="references-and-further-reading">References and Further Reading</h2>
<section id="foundational-academic-literature" class="level3">
<h3 class="anchored" data-anchor-id="foundational-academic-literature">Foundational Academic Literature</h3>
<ol type="1">
<li><strong>Markowitz, H. (1952).</strong> “Portfolio Selection.” <em>Journal of Finance</em>, 7(1), 77-91. [Seminal paper introducing mean-variance optimization]</li>
<li><strong>Sharpe, W. F. (1964).</strong> “Capital Asset Prices: A Theory of Market Equilibrium under Conditions of Risk.” <em>Journal of Finance</em>, 19(3), 425-442. [Development of CAPM based on Markowitz framework]</li>
<li><strong>Black, F., &amp; Litterman, R. (1992).</strong> “Global Portfolio Optimization.” <em>Financial Analysts Journal</em>, 48(5), 28-43. [Bayesian approach to parameter estimation]</li>
</ol>
</section>
<section id="advanced-theoretical-developments" class="level3">
<h3 class="anchored" data-anchor-id="advanced-theoretical-developments">Advanced Theoretical Developments</h3>
<ol start="4" type="1">
<li><strong>Merton, R. C. (1972).</strong> “An Analytic Derivation of the Efficient Portfolio Frontier.” <em>Journal of Financial and Quantitative Analysis</em>, 7(4), 1851-1872.</li>
<li><strong>Jobson, J. D., &amp; Korkie, B. (1980).</strong> “Estimation for Markowitz Efficient Portfolios.” <em>Journal of the American Statistical Association</em>, 75(371), 544-554.</li>
<li><strong>Michaud, R. O. (1989).</strong> “The Markowitz Optimization Enigma: Is ‘Optimized’ Optimal?” <em>Financial Analysts Journal</em>, 45(1), 31-42.</li>
</ol>
</section>
<section id="contemporary-research-and-extensions" class="level3">
<h3 class="anchored" data-anchor-id="contemporary-research-and-extensions">Contemporary Research and Extensions</h3>
<ol start="7" type="1">
<li><strong>DeMiguel, V., Garlappi, L., &amp; Uppal, R. (2009).</strong> “Optimal Versus Naive Diversification: How Inefficient is the 1/N Portfolio Strategy?” <em>Review of Financial Studies</em>, 22(5), 1915-1953.</li>
<li><strong>Ledoit, O., &amp; Wolf, M. (2003).</strong> “Improved Estimation of the Covariance Matrix of Stock Returns With an Application to Portfolio Selection.” <em>Journal of Empirical Finance</em>, 10(5), 603-621.</li>
</ol>
</section>
<section id="textbooks-and-comprehensive-references" class="level3">
<h3 class="anchored" data-anchor-id="textbooks-and-comprehensive-references">Textbooks and Comprehensive References</h3>
<ol type="1">
<li><strong>Elton, E. J., Gruber, M. J., Brown, S. J., &amp; Goetzmann, W. N. (2014).</strong> <em>Modern Portfolio Theory and Investment Analysis</em> (9th ed.). John Wiley &amp; Sons.</li>
<li><strong>Bodie, Z., Kane, A., &amp; Marcus, A. J. (2021).</strong> <em>Investments</em> (12th ed.). McGraw-Hill Education.</li>
<li><strong>Campbell, J. Y., Lo, A. W., &amp; MacKinlay, A. C. (1997).</strong> <em>The Econometrics of Financial Markets</em>. Princeton University Press.</li>
</ol>
</section>
<section id="computational-resources-for-r" class="level3">
<h3 class="anchored" data-anchor-id="computational-resources-for-r">Computational Resources for R</h3>
<ol type="1">
<li><strong><code>PerformanceAnalytics</code></strong> - Comprehensive portfolio performance analysis and risk management</li>
<li><strong><code>quadprog</code></strong> - Quadratic programming for mean-variance optimization</li>
<li><strong><code>fPortfolio</code></strong> - Advanced portfolio optimization and backtesting framework</li>
<li><strong><code>quantmod</code></strong> - Quantitative financial modeling and data management</li>
<li><strong><code>PortfolioAnalytics</code></strong> - Flexible portfolio optimization with multiple objectives</li>
</ol>
</section>
<section id="professional-and-institutional-resources" class="level3">
<h3 class="anchored" data-anchor-id="professional-and-institutional-resources">Professional and Institutional Resources</h3>
<ol type="1">
<li><strong>CFA Institute Research Foundation</strong> - Applied portfolio management research</li>
<li><strong>Journal of Portfolio Management</strong> - Practitioner-oriented portfolio theory research<br>
</li>
<li><strong>CRAN Task View: Finance</strong> - Comprehensive listing of R packages for computational finance</li>
</ol>
</section>
<section id="regulatory-and-industry-standards" class="level3">
<h3 class="anchored" data-anchor-id="regulatory-and-industry-standards">Regulatory and Industry Standards</h3>
<ol type="1">
<li><strong>GIPS Standards</strong> - Global Investment Performance Standards for portfolio measurement</li>
<li><strong>Risk Management Guidelines</strong> - Basel Committee and regulatory frameworks for institutional risk management</li>
</ol>
<p><strong>Disclaimer:</strong> This article is intended for educational purposes only and does not constitute investment advice. Students and practitioners should consult qualified financial professionals before making investment decisions and consider the regulatory requirements applicable to their jurisdiction.</p>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb39" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Portfolio Optimization: A Simple Guide to Mean Variance Analysis"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Krishna Kumar Shrestha"</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-07-13"</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [finance, portfolio optimization, mean variance, risk management, R]</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "A beginner-friendly guide to portfolio optimization using Mean Variance Analysis in R. Learn how to build optimal portfolios that balance risk and return."</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="fu"># Portfolio Optimization: A Simple Guide to Mean Variance Analysis</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## What You'll Learn</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>This comprehensive guide covers everything about portfolio optimization:</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Fundamentals:** What is portfolio optimization and why it matters</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Theory:** Understanding risk, return, and diversification</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Implementation:** Step-by-step R code with real stock data</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Practical Examples:** Building optimal portfolios</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Limitations:** What to watch out for in real-world applications</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>Portfolio optimization addresses a fundamental challenge in financial economics: how to allocate capital across multiple assets to achieve optimal risk-return characteristics. The central question involves determining the appropriate weights for each asset in a portfolio to either maximize expected return for a given level of risk or minimize risk for a targeted return level.</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>The diversification principle suggests that investing in a single asset exposes investors to unnecessary idiosyncratic risk, whereas spreading investments across multiple assets can reduce overall portfolio volatility without proportionally reducing expected returns.</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>This article examines **Mean Variance Optimization (MVO)**, the foundational framework developed by Harry Markowitz in 1952, which earned him the Nobel Prize in Economic Sciences in 1990. We provide theoretical foundations, mathematical formulations, and practical implementation using R programming language.</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## Portfolio Optimization: Theoretical Framework</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>Portfolio optimization is the systematic process of selecting optimal asset weights to construct portfolios that satisfy specific investment objectives under given constraints. The optimization process seeks to balance the trade-off between expected return and risk through mathematical modeling.</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>**Fundamental Concepts:**</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Portfolio:** A collection of financial assets (securities, bonds, derivatives) held by an investor</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Expected Return:** The anticipated return on an investment based on historical data or forward-looking estimates</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Risk:** The degree of uncertainty associated with investment returns, typically measured by volatility</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Optimization:** The mathematical process of finding optimal asset allocation weights</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>The theoretical foundation rests on the principle that rational investors prefer higher returns for any given level of risk, and lower risk for any given level of expected return. Portfolio construction therefore involves finding combinations that lie on the efficient frontier of this risk-return space.</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## Risk and Return Analysis</span></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>Understanding the relationship between risk and return forms the cornerstone of modern portfolio theory. These concepts require precise definition and measurement for effective portfolio construction.</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a><span class="fu">### Expected Return</span></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>Expected return represents the anticipated performance of an asset or portfolio over a specified time horizon. It can be calculated using historical data or forward-looking projections.</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>**Mathematical Definition:**</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>For an asset with historical returns $R_1, R_2, ..., R_T$, the expected return is:</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>$$E<span class="co">[</span><span class="ot">R</span><span class="co">]</span> = \frac{1}{T}\sum_{t=1}^{T} R_t$$</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>**Return Classifications:**</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Historical Return:** Calculated from past price movements</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Expected Return:** Forward-looking estimate based on various methodologies</span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a><span class="fu">### Risk Measurement</span></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>Risk quantifies the uncertainty surrounding investment outcomes, typically measured through volatility metrics.</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>**Volatility (Standard Deviation):**</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>$$\sigma = \sqrt{\frac{1}{T-1}\sum_{t=1}^{T}(R_t - E<span class="co">[</span><span class="ot">R</span><span class="co">]</span>)^2}$$</span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>**Risk Categories:**</span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Systematic Risk:** Market-wide risk that cannot be diversified away</span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Unsystematic Risk:** Asset-specific risk that can be reduced through diversification</span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Risk-Return Trade-off</span></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>Financial theory establishes that higher expected returns generally require accepting higher levels of risk. This fundamental relationship drives portfolio optimization decisions and forms the basis for asset pricing models.</span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mean Variance Optimization Framework</span></span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a>Mean Variance Optimization (MVO) provides a mathematical framework for constructing portfolios that optimize the risk-return trade-off. The methodology considers expected returns, variances, and covariances of assets to determine optimal allocation weights.</span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a>**Mathematical Formulation:**</span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a>For a portfolio with weights $w = (w_1, w_2, ..., w_n)$ and expected returns $\mu = (\mu_1, \mu_2, ..., \mu_n)$:</span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Portfolio Expected Return:** $E<span class="co">[</span><span class="ot">R_p</span><span class="co">]</span> = w^T\mu$</span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Portfolio Variance:** $\sigma_p^2 = w^T\Sigma w$</span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Portfolio Standard Deviation:** $\sigma_p = \sqrt{w^T\Sigma w}$</span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a>Where $\Sigma$ represents the covariance matrix of asset returns.</span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a>**Optimization Objectives:**</span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Risk Minimization:** Minimize $\sigma_p^2$ subject to $w^T\mu = \mu_p$ (target return)</span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Return Maximization:** Maximize $w^T\mu$ subject to $w^T\Sigma w = \sigma_p^2$ (target risk)</span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Utility Maximization:** Maximize $w^T\mu - \frac{\gamma}{2}w^T\Sigma w$ (risk-adjusted return)</span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a>**The Efficient Frontier:**</span>
<span id="cb39-107"><a href="#cb39-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-108"><a href="#cb39-108" aria-hidden="true" tabindex="-1"></a>The efficient frontier represents the set of portfolios that offer the highest expected return for each level of risk, or equivalently, the lowest risk for each level of expected return. Mathematically, it forms the upper boundary of the feasible risk-return space.</span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretical Assumptions</span></span>
<span id="cb39-111"><a href="#cb39-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-112"><a href="#cb39-112" aria-hidden="true" tabindex="-1"></a>Mean Variance Optimization operates under several key assumptions that define its scope of applicability and limitations:</span>
<span id="cb39-113"><a href="#cb39-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-114"><a href="#cb39-114" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. Rational Investor Behavior</span></span>
<span id="cb39-115"><a href="#cb39-115" aria-hidden="true" tabindex="-1"></a>**Assumption:** Investors exhibit risk-averse preferences and seek to maximize expected utility.</span>
<span id="cb39-116"><a href="#cb39-116" aria-hidden="true" tabindex="-1"></a>**Implication:** Investors require higher expected returns to compensate for additional risk.</span>
<span id="cb39-117"><a href="#cb39-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-118"><a href="#cb39-118" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. Normal Distribution of Returns</span></span>
<span id="cb39-119"><a href="#cb39-119" aria-hidden="true" tabindex="-1"></a>**Assumption:** Asset returns follow a multivariate normal distribution.</span>
<span id="cb39-120"><a href="#cb39-120" aria-hidden="true" tabindex="-1"></a>**Implication:** Portfolio returns are completely characterized by mean and variance parameters.</span>
<span id="cb39-121"><a href="#cb39-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-122"><a href="#cb39-122" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. Mean-Variance Preferences</span></span>
<span id="cb39-123"><a href="#cb39-123" aria-hidden="true" tabindex="-1"></a>**Assumption:** Investor utility functions depend solely on portfolio mean and variance.</span>
<span id="cb39-124"><a href="#cb39-124" aria-hidden="true" tabindex="-1"></a>**Implication:** Higher-order moments (skewness, kurtosis) are not considered in optimization.</span>
<span id="cb39-125"><a href="#cb39-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-126"><a href="#cb39-126" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. Single-Period Framework</span></span>
<span id="cb39-127"><a href="#cb39-127" aria-hidden="true" tabindex="-1"></a>**Assumption:** Portfolio optimization occurs over a single investment horizon.</span>
<span id="cb39-128"><a href="#cb39-128" aria-hidden="true" tabindex="-1"></a>**Implication:** Dynamic rebalancing and multi-period considerations are excluded.</span>
<span id="cb39-129"><a href="#cb39-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-130"><a href="#cb39-130" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5. Frictionless Markets</span></span>
<span id="cb39-131"><a href="#cb39-131" aria-hidden="true" tabindex="-1"></a>**Assumption:** Markets operate without transaction costs, taxes, or liquidity constraints.</span>
<span id="cb39-132"><a href="#cb39-132" aria-hidden="true" tabindex="-1"></a>**Implication:** Continuous rebalancing is costless and feasible.</span>
<span id="cb39-133"><a href="#cb39-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-134"><a href="#cb39-134" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6. Homogeneous Expectations</span></span>
<span id="cb39-135"><a href="#cb39-135" aria-hidden="true" tabindex="-1"></a>**Assumption:** All investors share identical beliefs about asset return distributions.</span>
<span id="cb39-136"><a href="#cb39-136" aria-hidden="true" tabindex="-1"></a>**Implication:** Market equilibrium can be characterized by a single efficient frontier.</span>
<span id="cb39-137"><a href="#cb39-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-138"><a href="#cb39-138" aria-hidden="true" tabindex="-1"></a><span class="fu">## Empirical Implementation</span></span>
<span id="cb39-139"><a href="#cb39-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-140"><a href="#cb39-140" aria-hidden="true" tabindex="-1"></a>This section demonstrates the practical application of Mean Variance Optimization using real financial data. We employ R programming to implement the theoretical framework and construct optimal portfolios.</span>
<span id="cb39-141"><a href="#cb39-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-142"><a href="#cb39-142" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. Environment Configuration</span></span>
<span id="cb39-143"><a href="#cb39-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-144"><a href="#cb39-144" aria-hidden="true" tabindex="-1"></a>The implementation requires several specialized R packages for financial data analysis and optimization procedures.</span>
<span id="cb39-145"><a href="#cb39-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-146"><a href="#cb39-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb39-147"><a href="#cb39-147" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: setup</span></span>
<span id="cb39-148"><a href="#cb39-148" aria-hidden="true" tabindex="-1"></a><span class="in">#| include: true</span></span>
<span id="cb39-149"><a href="#cb39-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-150"><a href="#cb39-150" aria-hidden="true" tabindex="-1"></a><span class="in"># Load required libraries for financial analysis</span></span>
<span id="cb39-151"><a href="#cb39-151" aria-hidden="true" tabindex="-1"></a><span class="in">library(quantmod)      # Financial data acquisition and manipulation</span></span>
<span id="cb39-152"><a href="#cb39-152" aria-hidden="true" tabindex="-1"></a><span class="in">library(PerformanceAnalytics)  # Portfolio performance analytics</span></span>
<span id="cb39-153"><a href="#cb39-153" aria-hidden="true" tabindex="-1"></a><span class="in">library(quadprog)      # Quadratic programming optimization</span></span>
<span id="cb39-154"><a href="#cb39-154" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)     # Data manipulation and visualization</span></span>
<span id="cb39-155"><a href="#cb39-155" aria-hidden="true" tabindex="-1"></a><span class="in">library(knitr)         # Dynamic report generation</span></span>
<span id="cb39-156"><a href="#cb39-156" aria-hidden="true" tabindex="-1"></a><span class="in">library(plotly)        # Interactive data visualization</span></span>
<span id="cb39-157"><a href="#cb39-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-158"><a href="#cb39-158" aria-hidden="true" tabindex="-1"></a><span class="in"># Configure global options for numerical precision</span></span>
<span id="cb39-159"><a href="#cb39-159" aria-hidden="true" tabindex="-1"></a><span class="in">options(digits = 4, scipen = 999)</span></span>
<span id="cb39-160"><a href="#cb39-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-161"><a href="#cb39-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-162"><a href="#cb39-162" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. Data Acquisition and Preprocessing</span></span>
<span id="cb39-163"><a href="#cb39-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-164"><a href="#cb39-164" aria-hidden="true" tabindex="-1"></a>We construct a diversified portfolio using equity securities from different economic sectors to demonstrate the principles of diversification and correlation effects.</span>
<span id="cb39-165"><a href="#cb39-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-166"><a href="#cb39-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r get-data}</span></span>
<span id="cb39-167"><a href="#cb39-167" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: get-data</span></span>
<span id="cb39-168"><a href="#cb39-168" aria-hidden="true" tabindex="-1"></a><span class="in">#| cache: true</span></span>
<span id="cb39-169"><a href="#cb39-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-170"><a href="#cb39-170" aria-hidden="true" tabindex="-1"></a><span class="in"># Define asset universe: diversified equity portfolio</span></span>
<span id="cb39-171"><a href="#cb39-171" aria-hidden="true" tabindex="-1"></a><span class="in">tickers &lt;- c("AAPL", "GOOGL", "JNJ", "JPM", "XOM")</span></span>
<span id="cb39-172"><a href="#cb39-172" aria-hidden="true" tabindex="-1"></a><span class="in">company_names &lt;- c("Apple Inc.", "Alphabet Inc.", "Johnson &amp; Johnson", </span></span>
<span id="cb39-173"><a href="#cb39-173" aria-hidden="true" tabindex="-1"></a><span class="in">                   "JPMorgan Chase &amp; Co.", "Exxon Mobil Corporation")</span></span>
<span id="cb39-174"><a href="#cb39-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-175"><a href="#cb39-175" aria-hidden="true" tabindex="-1"></a><span class="in"># Define analysis period: 5-year historical window</span></span>
<span id="cb39-176"><a href="#cb39-176" aria-hidden="true" tabindex="-1"></a><span class="in">analysis_start &lt;- Sys.Date() - 365*5</span></span>
<span id="cb39-177"><a href="#cb39-177" aria-hidden="true" tabindex="-1"></a><span class="in">analysis_end &lt;- Sys.Date()</span></span>
<span id="cb39-178"><a href="#cb39-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-179"><a href="#cb39-179" aria-hidden="true" tabindex="-1"></a><span class="in"># Retrieve adjusted closing prices from Yahoo Finance</span></span>
<span id="cb39-180"><a href="#cb39-180" aria-hidden="true" tabindex="-1"></a><span class="in">price_data &lt;- list()</span></span>
<span id="cb39-181"><a href="#cb39-181" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in seq_along(tickers)) {</span></span>
<span id="cb39-182"><a href="#cb39-182" aria-hidden="true" tabindex="-1"></a><span class="in">  price_data[[tickers[i]]] &lt;- getSymbols(tickers[i], </span></span>
<span id="cb39-183"><a href="#cb39-183" aria-hidden="true" tabindex="-1"></a><span class="in">                                        src = "yahoo", </span></span>
<span id="cb39-184"><a href="#cb39-184" aria-hidden="true" tabindex="-1"></a><span class="in">                                        from = analysis_start, </span></span>
<span id="cb39-185"><a href="#cb39-185" aria-hidden="true" tabindex="-1"></a><span class="in">                                        to = analysis_end, </span></span>
<span id="cb39-186"><a href="#cb39-186" aria-hidden="true" tabindex="-1"></a><span class="in">                                        auto.assign = FALSE)</span></span>
<span id="cb39-187"><a href="#cb39-187" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb39-188"><a href="#cb39-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-189"><a href="#cb39-189" aria-hidden="true" tabindex="-1"></a><span class="in"># Extract adjusted closing prices and construct price matrix</span></span>
<span id="cb39-190"><a href="#cb39-190" aria-hidden="true" tabindex="-1"></a><span class="in">prices &lt;- data.frame(date = index(price_data[[1]]))</span></span>
<span id="cb39-191"><a href="#cb39-191" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in seq_along(tickers)) {</span></span>
<span id="cb39-192"><a href="#cb39-192" aria-hidden="true" tabindex="-1"></a><span class="in">  prices[tickers[i]] &lt;- as.numeric(Ad(price_data[[tickers[i]]]))</span></span>
<span id="cb39-193"><a href="#cb39-193" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb39-194"><a href="#cb39-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-195"><a href="#cb39-195" aria-hidden="true" tabindex="-1"></a><span class="in"># Display data summary</span></span>
<span id="cb39-196"><a href="#cb39-196" aria-hidden="true" tabindex="-1"></a><span class="in">head(prices) |&gt; kable(caption = "Sample of Historical Price Data")</span></span>
<span id="cb39-197"><a href="#cb39-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-198"><a href="#cb39-198" aria-hidden="true" tabindex="-1"></a><span class="in"># Dataset characteristics</span></span>
<span id="cb39-199"><a href="#cb39-199" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Analysis Period:", format(min(prices$date), "%Y-%m-%d"), "to", </span></span>
<span id="cb39-200"><a href="#cb39-200" aria-hidden="true" tabindex="-1"></a><span class="in">    format(max(prices$date), "%Y-%m-%d"), "\n")</span></span>
<span id="cb39-201"><a href="#cb39-201" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Total Observations:", nrow(prices), "\n")</span></span>
<span id="cb39-202"><a href="#cb39-202" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Assets in Universe:", length(tickers), "\n")</span></span>
<span id="cb39-203"><a href="#cb39-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-204"><a href="#cb39-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-205"><a href="#cb39-205" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. Return Calculation and Statistical Analysis</span></span>
<span id="cb39-206"><a href="#cb39-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-207"><a href="#cb39-207" aria-hidden="true" tabindex="-1"></a>Portfolio optimization requires return data rather than price levels. We calculate logarithmic returns and compute relevant statistical measures.</span>
<span id="cb39-208"><a href="#cb39-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-209"><a href="#cb39-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r calculate-returns}</span></span>
<span id="cb39-210"><a href="#cb39-210" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: calculate-returns</span></span>
<span id="cb39-211"><a href="#cb39-211" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Time series of daily returns for selected assets"</span></span>
<span id="cb39-212"><a href="#cb39-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-213"><a href="#cb39-213" aria-hidden="true" tabindex="-1"></a><span class="in"># Calculate logarithmic returns</span></span>
<span id="cb39-214"><a href="#cb39-214" aria-hidden="true" tabindex="-1"></a><span class="in">returns &lt;- prices |&gt;</span></span>
<span id="cb39-215"><a href="#cb39-215" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-date) |&gt;</span></span>
<span id="cb39-216"><a href="#cb39-216" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(everything(), ~ c(NA, diff(log(.))))) |&gt;  # Log returns</span></span>
<span id="cb39-217"><a href="#cb39-217" aria-hidden="true" tabindex="-1"></a><span class="in">  na.omit()</span></span>
<span id="cb39-218"><a href="#cb39-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-219"><a href="#cb39-219" aria-hidden="true" tabindex="-1"></a><span class="in"># Convert to matrix format for mathematical operations</span></span>
<span id="cb39-220"><a href="#cb39-220" aria-hidden="true" tabindex="-1"></a><span class="in">returns_matrix &lt;- as.matrix(returns)</span></span>
<span id="cb39-221"><a href="#cb39-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-222"><a href="#cb39-222" aria-hidden="true" tabindex="-1"></a><span class="in"># Compute descriptive statistics (annualized)</span></span>
<span id="cb39-223"><a href="#cb39-223" aria-hidden="true" tabindex="-1"></a><span class="in">descriptive_stats &lt;- data.frame(</span></span>
<span id="cb39-224"><a href="#cb39-224" aria-hidden="true" tabindex="-1"></a><span class="in">  Asset = company_names,</span></span>
<span id="cb39-225"><a href="#cb39-225" aria-hidden="true" tabindex="-1"></a><span class="in">  Ticker = tickers,</span></span>
<span id="cb39-226"><a href="#cb39-226" aria-hidden="true" tabindex="-1"></a><span class="in">  Mean_Return = round(colMeans(returns) * 252, 4),  # Annualized mean</span></span>
<span id="cb39-227"><a href="#cb39-227" aria-hidden="true" tabindex="-1"></a><span class="in">  Volatility = round(apply(returns, 2, sd) * sqrt(252), 4),  # Annualized volatility</span></span>
<span id="cb39-228"><a href="#cb39-228" aria-hidden="true" tabindex="-1"></a><span class="in">  Minimum = round(apply(returns, 2, min), 4),       # Minimum daily return</span></span>
<span id="cb39-229"><a href="#cb39-229" aria-hidden="true" tabindex="-1"></a><span class="in">  Maximum = round(apply(returns, 2, max), 4)        # Maximum daily return</span></span>
<span id="cb39-230"><a href="#cb39-230" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb39-231"><a href="#cb39-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-232"><a href="#cb39-232" aria-hidden="true" tabindex="-1"></a><span class="in">kable(descriptive_stats, </span></span>
<span id="cb39-233"><a href="#cb39-233" aria-hidden="true" tabindex="-1"></a><span class="in">      caption = "Asset Return Statistics (Annualized Measures)",</span></span>
<span id="cb39-234"><a href="#cb39-234" aria-hidden="true" tabindex="-1"></a><span class="in">      col.names = c("Company", "Ticker", "Mean Return", "Volatility", </span></span>
<span id="cb39-235"><a href="#cb39-235" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Min Return", "Max Return"))</span></span>
<span id="cb39-236"><a href="#cb39-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-237"><a href="#cb39-237" aria-hidden="true" tabindex="-1"></a><span class="in"># Visualize return time series</span></span>
<span id="cb39-238"><a href="#cb39-238" aria-hidden="true" tabindex="-1"></a><span class="in">returns_long &lt;- returns |&gt;</span></span>
<span id="cb39-239"><a href="#cb39-239" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(date = prices$date[-1]) |&gt;</span></span>
<span id="cb39-240"><a href="#cb39-240" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(cols = -date, names_to = "asset", values_to = "return")</span></span>
<span id="cb39-241"><a href="#cb39-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-242"><a href="#cb39-242" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- ggplot(returns_long, aes(x = date, y = return, color = asset)) +</span></span>
<span id="cb39-243"><a href="#cb39-243" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(alpha = 0.7, size = 0.5) +</span></span>
<span id="cb39-244"><a href="#cb39-244" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~asset, scales = "free_y", nrow = 3) +</span></span>
<span id="cb39-245"><a href="#cb39-245" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Daily Return Time Series by Asset",</span></span>
<span id="cb39-246"><a href="#cb39-246" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "5-Year Analysis Period",</span></span>
<span id="cb39-247"><a href="#cb39-247" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "Date", y = "Daily Return") +</span></span>
<span id="cb39-248"><a href="#cb39-248" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb39-249"><a href="#cb39-249" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none",</span></span>
<span id="cb39-250"><a href="#cb39-250" aria-hidden="true" tabindex="-1"></a><span class="in">        strip.text = element_text(size = 10))</span></span>
<span id="cb39-251"><a href="#cb39-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-252"><a href="#cb39-252" aria-hidden="true" tabindex="-1"></a><span class="in">print(p1)</span></span>
<span id="cb39-253"><a href="#cb39-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-254"><a href="#cb39-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-255"><a href="#cb39-255" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. Correlation Structure Analysis</span></span>
<span id="cb39-256"><a href="#cb39-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-257"><a href="#cb39-257" aria-hidden="true" tabindex="-1"></a>Correlation analysis reveals the degree of linear dependence between asset returns, which directly impacts diversification benefits and optimal portfolio weights.</span>
<span id="cb39-258"><a href="#cb39-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-259"><a href="#cb39-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r correlations}</span></span>
<span id="cb39-260"><a href="#cb39-260" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: correlations</span></span>
<span id="cb39-261"><a href="#cb39-261" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Asset correlation matrix and heatmap visualization"</span></span>
<span id="cb39-262"><a href="#cb39-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-263"><a href="#cb39-263" aria-hidden="true" tabindex="-1"></a><span class="in"># Compute empirical correlation matrix</span></span>
<span id="cb39-264"><a href="#cb39-264" aria-hidden="true" tabindex="-1"></a><span class="in">correlation_matrix &lt;- cor(returns)</span></span>
<span id="cb39-265"><a href="#cb39-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-266"><a href="#cb39-266" aria-hidden="true" tabindex="-1"></a><span class="in"># Format correlation matrix for presentation</span></span>
<span id="cb39-267"><a href="#cb39-267" aria-hidden="true" tabindex="-1"></a><span class="in">correlation_display &lt;- correlation_matrix</span></span>
<span id="cb39-268"><a href="#cb39-268" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(correlation_display) &lt;- company_names</span></span>
<span id="cb39-269"><a href="#cb39-269" aria-hidden="true" tabindex="-1"></a><span class="in">rownames(correlation_display) &lt;- company_names</span></span>
<span id="cb39-270"><a href="#cb39-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-271"><a href="#cb39-271" aria-hidden="true" tabindex="-1"></a><span class="in">kable(correlation_display, </span></span>
<span id="cb39-272"><a href="#cb39-272" aria-hidden="true" tabindex="-1"></a><span class="in">      caption = "Pairwise Correlation Matrix of Asset Returns",</span></span>
<span id="cb39-273"><a href="#cb39-273" aria-hidden="true" tabindex="-1"></a><span class="in">      digits = 3)</span></span>
<span id="cb39-274"><a href="#cb39-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-275"><a href="#cb39-275" aria-hidden="true" tabindex="-1"></a><span class="in"># Prepare data for correlation heatmap</span></span>
<span id="cb39-276"><a href="#cb39-276" aria-hidden="true" tabindex="-1"></a><span class="in">correlation_long &lt;- correlation_matrix |&gt;</span></span>
<span id="cb39-277"><a href="#cb39-277" aria-hidden="true" tabindex="-1"></a><span class="in">  as.data.frame() |&gt;</span></span>
<span id="cb39-278"><a href="#cb39-278" aria-hidden="true" tabindex="-1"></a><span class="in">  rownames_to_column("asset1") |&gt;</span></span>
<span id="cb39-279"><a href="#cb39-279" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(cols = -asset1, names_to = "asset2", values_to = "correlation") |&gt;</span></span>
<span id="cb39-280"><a href="#cb39-280" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb39-281"><a href="#cb39-281" aria-hidden="true" tabindex="-1"></a><span class="in">    asset1 = factor(asset1, levels = tickers, labels = company_names),</span></span>
<span id="cb39-282"><a href="#cb39-282" aria-hidden="true" tabindex="-1"></a><span class="in">    asset2 = factor(asset2, levels = tickers, labels = company_names)</span></span>
<span id="cb39-283"><a href="#cb39-283" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb39-284"><a href="#cb39-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-285"><a href="#cb39-285" aria-hidden="true" tabindex="-1"></a><span class="in"># Generate correlation heatmap</span></span>
<span id="cb39-286"><a href="#cb39-286" aria-hidden="true" tabindex="-1"></a><span class="in">p2 &lt;- ggplot(correlation_long, aes(x = asset1, y = asset2, fill = correlation)) +</span></span>
<span id="cb39-287"><a href="#cb39-287" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_tile(color = "white", size = 0.5) +</span></span>
<span id="cb39-288"><a href="#cb39-288" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_gradient2(low = "blue", mid = "white", high = "red", </span></span>
<span id="cb39-289"><a href="#cb39-289" aria-hidden="true" tabindex="-1"></a><span class="in">                       midpoint = 0, limits = c(-1, 1)) +</span></span>
<span id="cb39-290"><a href="#cb39-290" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Asset Return Correlation Matrix",</span></span>
<span id="cb39-291"><a href="#cb39-291" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "Heatmap Visualization",</span></span>
<span id="cb39-292"><a href="#cb39-292" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "Asset", y = "Asset", fill = "Correlation") +</span></span>
<span id="cb39-293"><a href="#cb39-293" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb39-294"><a href="#cb39-294" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 9),</span></span>
<span id="cb39-295"><a href="#cb39-295" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(size = 9),</span></span>
<span id="cb39-296"><a href="#cb39-296" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "right") +</span></span>
<span id="cb39-297"><a href="#cb39-297" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_fixed()</span></span>
<span id="cb39-298"><a href="#cb39-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-299"><a href="#cb39-299" aria-hidden="true" tabindex="-1"></a><span class="in">print(p2)</span></span>
<span id="cb39-300"><a href="#cb39-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-301"><a href="#cb39-301" aria-hidden="true" tabindex="-1"></a><span class="in"># Calculate and display diversification metrics</span></span>
<span id="cb39-302"><a href="#cb39-302" aria-hidden="true" tabindex="-1"></a><span class="in">mean_correlation &lt;- mean(correlation_matrix[upper.tri(correlation_matrix)])</span></span>
<span id="cb39-303"><a href="#cb39-303" aria-hidden="true" tabindex="-1"></a><span class="in">max_correlation &lt;- max(correlation_matrix[upper.tri(correlation_matrix)])</span></span>
<span id="cb39-304"><a href="#cb39-304" aria-hidden="true" tabindex="-1"></a><span class="in">min_correlation &lt;- min(correlation_matrix[upper.tri(correlation_matrix)])</span></span>
<span id="cb39-305"><a href="#cb39-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-306"><a href="#cb39-306" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Correlation Analysis Summary:\n")</span></span>
<span id="cb39-307"><a href="#cb39-307" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Mean Pairwise Correlation:", round(mean_correlation, 3), "\n")</span></span>
<span id="cb39-308"><a href="#cb39-308" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Maximum Correlation:", round(max_correlation, 3), "\n")</span></span>
<span id="cb39-309"><a href="#cb39-309" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Minimum Correlation:", round(min_correlation, 3), "\n")</span></span>
<span id="cb39-310"><a href="#cb39-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-311"><a href="#cb39-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-312"><a href="#cb39-312" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5. Optimization Algorithm Implementation</span></span>
<span id="cb39-313"><a href="#cb39-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-314"><a href="#cb39-314" aria-hidden="true" tabindex="-1"></a>We implement the quadratic programming solution to the mean-variance optimization problem using the standard mathematical formulation.</span>
<span id="cb39-315"><a href="#cb39-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-316"><a href="#cb39-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r optimization-setup}</span></span>
<span id="cb39-317"><a href="#cb39-317" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: optimization-setup</span></span>
<span id="cb39-318"><a href="#cb39-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-319"><a href="#cb39-319" aria-hidden="true" tabindex="-1"></a><span class="in"># Calculate optimization inputs</span></span>
<span id="cb39-320"><a href="#cb39-320" aria-hidden="true" tabindex="-1"></a><span class="in">mu &lt;- colMeans(returns) * 252    # Annualized expected returns vector</span></span>
<span id="cb39-321"><a href="#cb39-321" aria-hidden="true" tabindex="-1"></a><span class="in">Sigma &lt;- cov(returns) * 252      # Annualized covariance matrix</span></span>
<span id="cb39-322"><a href="#cb39-322" aria-hidden="true" tabindex="-1"></a><span class="in">n_assets &lt;- length(mu)           # Number of assets in universe</span></span>
<span id="cb39-323"><a href="#cb39-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-324"><a href="#cb39-324" aria-hidden="true" tabindex="-1"></a><span class="in"># Define portfolio optimization function</span></span>
<span id="cb39-325"><a href="#cb39-325" aria-hidden="true" tabindex="-1"></a><span class="in">optimize_portfolio &lt;- function(target_return = NULL, risk_aversion = NULL) {</span></span>
<span id="cb39-326"><a href="#cb39-326" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-327"><a href="#cb39-327" aria-hidden="true" tabindex="-1"></a><span class="in">  # Constraint matrices: weights sum to 1, non-negativity constraints</span></span>
<span id="cb39-328"><a href="#cb39-328" aria-hidden="true" tabindex="-1"></a><span class="in">  A_equality &lt;- matrix(rep(1, n_assets), nrow = 1)  # Budget constraint</span></span>
<span id="cb39-329"><a href="#cb39-329" aria-hidden="true" tabindex="-1"></a><span class="in">  A_inequality &lt;- diag(n_assets)                     # Non-negativity constraints</span></span>
<span id="cb39-330"><a href="#cb39-330" aria-hidden="true" tabindex="-1"></a><span class="in">  Amat &lt;- rbind(A_equality, A_inequality)</span></span>
<span id="cb39-331"><a href="#cb39-331" aria-hidden="true" tabindex="-1"></a><span class="in">  bvec &lt;- c(1, rep(0, n_assets))</span></span>
<span id="cb39-332"><a href="#cb39-332" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-333"><a href="#cb39-333" aria-hidden="true" tabindex="-1"></a><span class="in">  if (!is.null(target_return)) {</span></span>
<span id="cb39-334"><a href="#cb39-334" aria-hidden="true" tabindex="-1"></a><span class="in">    # Minimize variance subject to target return constraint</span></span>
<span id="cb39-335"><a href="#cb39-335" aria-hidden="true" tabindex="-1"></a><span class="in">    A_return &lt;- matrix(mu, nrow = 1)</span></span>
<span id="cb39-336"><a href="#cb39-336" aria-hidden="true" tabindex="-1"></a><span class="in">    Amat &lt;- rbind(A_return, Amat)</span></span>
<span id="cb39-337"><a href="#cb39-337" aria-hidden="true" tabindex="-1"></a><span class="in">    bvec &lt;- c(target_return, bvec)</span></span>
<span id="cb39-338"><a href="#cb39-338" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb39-339"><a href="#cb39-339" aria-hidden="true" tabindex="-1"></a><span class="in">    # Solve quadratic programming problem: min(1/2 * w'Qw) s.t. Aw &gt;= b</span></span>
<span id="cb39-340"><a href="#cb39-340" aria-hidden="true" tabindex="-1"></a><span class="in">    solution &lt;- solve.QP(Dmat = 2*Sigma, dvec = rep(0, n_assets), </span></span>
<span id="cb39-341"><a href="#cb39-341" aria-hidden="true" tabindex="-1"></a><span class="in">                        Amat = t(Amat), bvec = bvec, meq = 2)</span></span>
<span id="cb39-342"><a href="#cb39-342" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb39-343"><a href="#cb39-343" aria-hidden="true" tabindex="-1"></a><span class="in">  } else if (!is.null(risk_aversion)) {</span></span>
<span id="cb39-344"><a href="#cb39-344" aria-hidden="true" tabindex="-1"></a><span class="in">    # Maximize utility: E[r] - (γ/2)σ²</span></span>
<span id="cb39-345"><a href="#cb39-345" aria-hidden="true" tabindex="-1"></a><span class="in">    dvec &lt;- mu</span></span>
<span id="cb39-346"><a href="#cb39-346" aria-hidden="true" tabindex="-1"></a><span class="in">    solution &lt;- solve.QP(Dmat = risk_aversion * Sigma, dvec = dvec, </span></span>
<span id="cb39-347"><a href="#cb39-347" aria-hidden="true" tabindex="-1"></a><span class="in">                        Amat = t(Amat), bvec = bvec, meq = 1)</span></span>
<span id="cb39-348"><a href="#cb39-348" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb39-349"><a href="#cb39-349" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-350"><a href="#cb39-350" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extract optimal weights</span></span>
<span id="cb39-351"><a href="#cb39-351" aria-hidden="true" tabindex="-1"></a><span class="in">  weights &lt;- solution$solution</span></span>
<span id="cb39-352"><a href="#cb39-352" aria-hidden="true" tabindex="-1"></a><span class="in">  names(weights) &lt;- tickers</span></span>
<span id="cb39-353"><a href="#cb39-353" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-354"><a href="#cb39-354" aria-hidden="true" tabindex="-1"></a><span class="in">  # Calculate portfolio performance metrics</span></span>
<span id="cb39-355"><a href="#cb39-355" aria-hidden="true" tabindex="-1"></a><span class="in">  portfolio_return &lt;- sum(weights * mu)</span></span>
<span id="cb39-356"><a href="#cb39-356" aria-hidden="true" tabindex="-1"></a><span class="in">  portfolio_variance &lt;- as.numeric(t(weights) %*% Sigma %*% weights)</span></span>
<span id="cb39-357"><a href="#cb39-357" aria-hidden="true" tabindex="-1"></a><span class="in">  portfolio_volatility &lt;- sqrt(portfolio_variance)</span></span>
<span id="cb39-358"><a href="#cb39-358" aria-hidden="true" tabindex="-1"></a><span class="in">  sharpe_ratio &lt;- portfolio_return / portfolio_volatility</span></span>
<span id="cb39-359"><a href="#cb39-359" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-360"><a href="#cb39-360" aria-hidden="true" tabindex="-1"></a><span class="in">  return(list(</span></span>
<span id="cb39-361"><a href="#cb39-361" aria-hidden="true" tabindex="-1"></a><span class="in">    weights = weights,</span></span>
<span id="cb39-362"><a href="#cb39-362" aria-hidden="true" tabindex="-1"></a><span class="in">    expected_return = portfolio_return,</span></span>
<span id="cb39-363"><a href="#cb39-363" aria-hidden="true" tabindex="-1"></a><span class="in">    volatility = portfolio_volatility,</span></span>
<span id="cb39-364"><a href="#cb39-364" aria-hidden="true" tabindex="-1"></a><span class="in">    sharpe_ratio = sharpe_ratio,</span></span>
<span id="cb39-365"><a href="#cb39-365" aria-hidden="true" tabindex="-1"></a><span class="in">    variance = portfolio_variance</span></span>
<span id="cb39-366"><a href="#cb39-366" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb39-367"><a href="#cb39-367" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb39-368"><a href="#cb39-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-369"><a href="#cb39-369" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Portfolio optimization algorithm successfully implemented.\n")</span></span>
<span id="cb39-370"><a href="#cb39-370" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Available optimization modes: target return, risk aversion parameter.\n")</span></span>
<span id="cb39-371"><a href="#cb39-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-372"><a href="#cb39-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-373"><a href="#cb39-373" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6. Finding Optimal Portfolios</span></span>
<span id="cb39-374"><a href="#cb39-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-375"><a href="#cb39-375" aria-hidden="true" tabindex="-1"></a>Let's find some interesting portfolios: minimum risk, maximum Sharpe ratio, and equal weight.</span>
<span id="cb39-376"><a href="#cb39-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-377"><a href="#cb39-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r optimal-portfolios}</span></span>
<span id="cb39-378"><a href="#cb39-378" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: optimal-portfolios</span></span>
<span id="cb39-379"><a href="#cb39-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-380"><a href="#cb39-380" aria-hidden="true" tabindex="-1"></a><span class="in"># 1. Minimum Risk Portfolio</span></span>
<span id="cb39-381"><a href="#cb39-381" aria-hidden="true" tabindex="-1"></a><span class="in">min_risk_port &lt;- optimize_portfolio(target_return = min(mu))</span></span>
<span id="cb39-382"><a href="#cb39-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-383"><a href="#cb39-383" aria-hidden="true" tabindex="-1"></a><span class="in"># 2. Maximum Return Portfolio (single asset)</span></span>
<span id="cb39-384"><a href="#cb39-384" aria-hidden="true" tabindex="-1"></a><span class="in">max_return_idx &lt;- which.max(mu)</span></span>
<span id="cb39-385"><a href="#cb39-385" aria-hidden="true" tabindex="-1"></a><span class="in">max_return_port &lt;- list(</span></span>
<span id="cb39-386"><a href="#cb39-386" aria-hidden="true" tabindex="-1"></a><span class="in">  weights = rep(0, n_assets),</span></span>
<span id="cb39-387"><a href="#cb39-387" aria-hidden="true" tabindex="-1"></a><span class="in">  expected_return = mu[max_return_idx],</span></span>
<span id="cb39-388"><a href="#cb39-388" aria-hidden="true" tabindex="-1"></a><span class="in">  volatility = sqrt(Sigma[max_return_idx, max_return_idx])</span></span>
<span id="cb39-389"><a href="#cb39-389" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb39-390"><a href="#cb39-390" aria-hidden="true" tabindex="-1"></a><span class="in">max_return_port$weights[max_return_idx] &lt;- 1</span></span>
<span id="cb39-391"><a href="#cb39-391" aria-hidden="true" tabindex="-1"></a><span class="in">names(max_return_port$weights) &lt;- tickers</span></span>
<span id="cb39-392"><a href="#cb39-392" aria-hidden="true" tabindex="-1"></a><span class="in">max_return_port$sharpe_ratio &lt;- max_return_port$expected_return / max_return_port$volatility</span></span>
<span id="cb39-393"><a href="#cb39-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-394"><a href="#cb39-394" aria-hidden="true" tabindex="-1"></a><span class="in"># 3. Equal Weight Portfolio</span></span>
<span id="cb39-395"><a href="#cb39-395" aria-hidden="true" tabindex="-1"></a><span class="in">equal_weight_port &lt;- list(</span></span>
<span id="cb39-396"><a href="#cb39-396" aria-hidden="true" tabindex="-1"></a><span class="in">  weights = rep(1/n_assets, n_assets),</span></span>
<span id="cb39-397"><a href="#cb39-397" aria-hidden="true" tabindex="-1"></a><span class="in">  expected_return = sum(mu/n_assets),</span></span>
<span id="cb39-398"><a href="#cb39-398" aria-hidden="true" tabindex="-1"></a><span class="in">  volatility = sqrt(t(rep(1/n_assets, n_assets)) %*% Sigma %*% rep(1/n_assets, n_assets))</span></span>
<span id="cb39-399"><a href="#cb39-399" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb39-400"><a href="#cb39-400" aria-hidden="true" tabindex="-1"></a><span class="in">names(equal_weight_port$weights) &lt;- tickers</span></span>
<span id="cb39-401"><a href="#cb39-401" aria-hidden="true" tabindex="-1"></a><span class="in">equal_weight_port$sharpe_ratio &lt;- equal_weight_port$expected_return / as.numeric(equal_weight_port$volatility)</span></span>
<span id="cb39-402"><a href="#cb39-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-403"><a href="#cb39-403" aria-hidden="true" tabindex="-1"></a><span class="in"># Create comparison table</span></span>
<span id="cb39-404"><a href="#cb39-404" aria-hidden="true" tabindex="-1"></a><span class="in">portfolio_comparison &lt;- data.frame(</span></span>
<span id="cb39-405"><a href="#cb39-405" aria-hidden="true" tabindex="-1"></a><span class="in">  Portfolio = c("Minimum Risk", "Maximum Return", "Equal Weight"),</span></span>
<span id="cb39-406"><a href="#cb39-406" aria-hidden="true" tabindex="-1"></a><span class="in">  Expected_Return = c(min_risk_port$expected_return, max_return_port$expected_return, equal_weight_port$expected_return),</span></span>
<span id="cb39-407"><a href="#cb39-407" aria-hidden="true" tabindex="-1"></a><span class="in">  Risk = c(min_risk_port$volatility, max_return_port$volatility, as.numeric(equal_weight_port$volatility)),</span></span>
<span id="cb39-408"><a href="#cb39-408" aria-hidden="true" tabindex="-1"></a><span class="in">  Sharpe_Ratio = c(min_risk_port$sharpe_ratio, max_return_port$sharpe_ratio, equal_weight_port$sharpe_ratio)</span></span>
<span id="cb39-409"><a href="#cb39-409" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb39-410"><a href="#cb39-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-411"><a href="#cb39-411" aria-hidden="true" tabindex="-1"></a><span class="in">kable(portfolio_comparison, </span></span>
<span id="cb39-412"><a href="#cb39-412" aria-hidden="true" tabindex="-1"></a><span class="in">      caption = "Comparison of Different Portfolio Strategies",</span></span>
<span id="cb39-413"><a href="#cb39-413" aria-hidden="true" tabindex="-1"></a><span class="in">      digits = 4)</span></span>
<span id="cb39-414"><a href="#cb39-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-415"><a href="#cb39-415" aria-hidden="true" tabindex="-1"></a><span class="in"># Show portfolio weights</span></span>
<span id="cb39-416"><a href="#cb39-416" aria-hidden="true" tabindex="-1"></a><span class="in">weights_comparison &lt;- data.frame(</span></span>
<span id="cb39-417"><a href="#cb39-417" aria-hidden="true" tabindex="-1"></a><span class="in">  Stock = company_names,</span></span>
<span id="cb39-418"><a href="#cb39-418" aria-hidden="true" tabindex="-1"></a><span class="in">  Min_Risk = round(min_risk_port$weights, 3),</span></span>
<span id="cb39-419"><a href="#cb39-419" aria-hidden="true" tabindex="-1"></a><span class="in">  Max_Return = round(max_return_port$weights, 3),</span></span>
<span id="cb39-420"><a href="#cb39-420" aria-hidden="true" tabindex="-1"></a><span class="in">  Equal_Weight = round(equal_weight_port$weights, 3)</span></span>
<span id="cb39-421"><a href="#cb39-421" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb39-422"><a href="#cb39-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-423"><a href="#cb39-423" aria-hidden="true" tabindex="-1"></a><span class="in">kable(weights_comparison, </span></span>
<span id="cb39-424"><a href="#cb39-424" aria-hidden="true" tabindex="-1"></a><span class="in">      caption = "Portfolio Weights for Different Strategies")</span></span>
<span id="cb39-425"><a href="#cb39-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-426"><a href="#cb39-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-427"><a href="#cb39-427" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7. Creating the Efficient Frontier</span></span>
<span id="cb39-428"><a href="#cb39-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-429"><a href="#cb39-429" aria-hidden="true" tabindex="-1"></a>The efficient frontier shows all optimal portfolios with different risk-return combinations.</span>
<span id="cb39-430"><a href="#cb39-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-431"><a href="#cb39-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r efficient-frontier}</span></span>
<span id="cb39-432"><a href="#cb39-432" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: efficient-frontier</span></span>
<span id="cb39-433"><a href="#cb39-433" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Efficient Frontier showing optimal risk-return combinations"</span></span>
<span id="cb39-434"><a href="#cb39-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-435"><a href="#cb39-435" aria-hidden="true" tabindex="-1"></a><span class="in"># Generate efficient frontier</span></span>
<span id="cb39-436"><a href="#cb39-436" aria-hidden="true" tabindex="-1"></a><span class="in">target_returns &lt;- seq(min(mu), max(mu), length.out = 50)</span></span>
<span id="cb39-437"><a href="#cb39-437" aria-hidden="true" tabindex="-1"></a><span class="in">efficient_portfolios &lt;- list()</span></span>
<span id="cb39-438"><a href="#cb39-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-439"><a href="#cb39-439" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in 1:length(target_returns)) {</span></span>
<span id="cb39-440"><a href="#cb39-440" aria-hidden="true" tabindex="-1"></a><span class="in">  tryCatch({</span></span>
<span id="cb39-441"><a href="#cb39-441" aria-hidden="true" tabindex="-1"></a><span class="in">    port &lt;- optimize_portfolio(target_return = target_returns[i])</span></span>
<span id="cb39-442"><a href="#cb39-442" aria-hidden="true" tabindex="-1"></a><span class="in">    efficient_portfolios[[i]] &lt;- data.frame(</span></span>
<span id="cb39-443"><a href="#cb39-443" aria-hidden="true" tabindex="-1"></a><span class="in">      return = port$expected_return,</span></span>
<span id="cb39-444"><a href="#cb39-444" aria-hidden="true" tabindex="-1"></a><span class="in">      risk = port$volatility,</span></span>
<span id="cb39-445"><a href="#cb39-445" aria-hidden="true" tabindex="-1"></a><span class="in">      sharpe = port$sharpe_ratio</span></span>
<span id="cb39-446"><a href="#cb39-446" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb39-447"><a href="#cb39-447" aria-hidden="true" tabindex="-1"></a><span class="in">  }, error = function(e) {</span></span>
<span id="cb39-448"><a href="#cb39-448" aria-hidden="true" tabindex="-1"></a><span class="in">    efficient_portfolios[[i]] &lt;- NULL</span></span>
<span id="cb39-449"><a href="#cb39-449" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb39-450"><a href="#cb39-450" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb39-451"><a href="#cb39-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-452"><a href="#cb39-452" aria-hidden="true" tabindex="-1"></a><span class="in"># Combine results</span></span>
<span id="cb39-453"><a href="#cb39-453" aria-hidden="true" tabindex="-1"></a><span class="in">efficient_frontier_data &lt;- do.call(rbind, efficient_portfolios)</span></span>
<span id="cb39-454"><a href="#cb39-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-455"><a href="#cb39-455" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot efficient frontier</span></span>
<span id="cb39-456"><a href="#cb39-456" aria-hidden="true" tabindex="-1"></a><span class="in">p3 &lt;- ggplot() +</span></span>
<span id="cb39-457"><a href="#cb39-457" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(data = efficient_frontier_data, </span></span>
<span id="cb39-458"><a href="#cb39-458" aria-hidden="true" tabindex="-1"></a><span class="in">            aes(x = risk, y = return), </span></span>
<span id="cb39-459"><a href="#cb39-459" aria-hidden="true" tabindex="-1"></a><span class="in">            color = "blue", size = 1.2) +</span></span>
<span id="cb39-460"><a href="#cb39-460" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(x = min_risk_port$volatility, y = min_risk_port$expected_return), </span></span>
<span id="cb39-461"><a href="#cb39-461" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "green", size = 3) +</span></span>
<span id="cb39-462"><a href="#cb39-462" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(x = as.numeric(equal_weight_port$volatility), y = equal_weight_port$expected_return), </span></span>
<span id="cb39-463"><a href="#cb39-463" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "orange", size = 3) +</span></span>
<span id="cb39-464"><a href="#cb39-464" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(x = max_return_port$volatility, y = max_return_port$expected_return), </span></span>
<span id="cb39-465"><a href="#cb39-465" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "red", size = 3) +</span></span>
<span id="cb39-466"><a href="#cb39-466" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Efficient Frontier",</span></span>
<span id="cb39-467"><a href="#cb39-467" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "Green = Min Risk, Orange = Equal Weight, Red = Max Return",</span></span>
<span id="cb39-468"><a href="#cb39-468" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "Risk (Standard Deviation)",</span></span>
<span id="cb39-469"><a href="#cb39-469" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "Expected Return") +</span></span>
<span id="cb39-470"><a href="#cb39-470" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb39-471"><a href="#cb39-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-472"><a href="#cb39-472" aria-hidden="true" tabindex="-1"></a><span class="in">print(p3)</span></span>
<span id="cb39-473"><a href="#cb39-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-474"><a href="#cb39-474" aria-hidden="true" tabindex="-1"></a><span class="in"># Add individual stock points</span></span>
<span id="cb39-475"><a href="#cb39-475" aria-hidden="true" tabindex="-1"></a><span class="in">individual_stocks &lt;- data.frame(</span></span>
<span id="cb39-476"><a href="#cb39-476" aria-hidden="true" tabindex="-1"></a><span class="in">  stock = company_names,</span></span>
<span id="cb39-477"><a href="#cb39-477" aria-hidden="true" tabindex="-1"></a><span class="in">  return = mu,</span></span>
<span id="cb39-478"><a href="#cb39-478" aria-hidden="true" tabindex="-1"></a><span class="in">  risk = sqrt(diag(Sigma))</span></span>
<span id="cb39-479"><a href="#cb39-479" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb39-480"><a href="#cb39-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-481"><a href="#cb39-481" aria-hidden="true" tabindex="-1"></a><span class="in">p4 &lt;- p3 + </span></span>
<span id="cb39-482"><a href="#cb39-482" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = individual_stocks, </span></span>
<span id="cb39-483"><a href="#cb39-483" aria-hidden="true" tabindex="-1"></a><span class="in">             aes(x = risk, y = return), </span></span>
<span id="cb39-484"><a href="#cb39-484" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "gray", size = 2) +</span></span>
<span id="cb39-485"><a href="#cb39-485" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(data = individual_stocks, </span></span>
<span id="cb39-486"><a href="#cb39-486" aria-hidden="true" tabindex="-1"></a><span class="in">            aes(x = risk, y = return, label = stock), </span></span>
<span id="cb39-487"><a href="#cb39-487" aria-hidden="true" tabindex="-1"></a><span class="in">            hjust = -0.1, vjust = -0.1, size = 3)</span></span>
<span id="cb39-488"><a href="#cb39-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-489"><a href="#cb39-489" aria-hidden="true" tabindex="-1"></a><span class="in">print(p4)</span></span>
<span id="cb39-490"><a href="#cb39-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-491"><a href="#cb39-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-492"><a href="#cb39-492" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practical Example: Building Your Portfolio</span></span>
<span id="cb39-493"><a href="#cb39-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-494"><a href="#cb39-494" aria-hidden="true" tabindex="-1"></a>Let's say you want to invest $10,000 with moderate risk tolerance. Here's how to determine your optimal portfolio:</span>
<span id="cb39-495"><a href="#cb39-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-496"><a href="#cb39-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r practical-example}</span></span>
<span id="cb39-497"><a href="#cb39-497" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: practical-example</span></span>
<span id="cb39-498"><a href="#cb39-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-499"><a href="#cb39-499" aria-hidden="true" tabindex="-1"></a><span class="in"># Let's find a portfolio with moderate risk (between min and max)</span></span>
<span id="cb39-500"><a href="#cb39-500" aria-hidden="true" tabindex="-1"></a><span class="in">target_risk &lt;- 0.15  # 15% annual volatility</span></span>
<span id="cb39-501"><a href="#cb39-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-502"><a href="#cb39-502" aria-hidden="true" tabindex="-1"></a><span class="in"># Find portfolio closest to target risk</span></span>
<span id="cb39-503"><a href="#cb39-503" aria-hidden="true" tabindex="-1"></a><span class="in">risk_differences &lt;- abs(efficient_frontier_data$risk - target_risk)</span></span>
<span id="cb39-504"><a href="#cb39-504" aria-hidden="true" tabindex="-1"></a><span class="in">best_idx &lt;- which.min(risk_differences)</span></span>
<span id="cb39-505"><a href="#cb39-505" aria-hidden="true" tabindex="-1"></a><span class="in">moderate_target_return &lt;- efficient_frontier_data$return[best_idx]</span></span>
<span id="cb39-506"><a href="#cb39-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-507"><a href="#cb39-507" aria-hidden="true" tabindex="-1"></a><span class="in">moderate_portfolio &lt;- optimize_portfolio(target_return = moderate_target_return)</span></span>
<span id="cb39-508"><a href="#cb39-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-509"><a href="#cb39-509" aria-hidden="true" tabindex="-1"></a><span class="in"># Calculate dollar amounts for $10,000 investment</span></span>
<span id="cb39-510"><a href="#cb39-510" aria-hidden="true" tabindex="-1"></a><span class="in">investment_amount &lt;- 10000</span></span>
<span id="cb39-511"><a href="#cb39-511" aria-hidden="true" tabindex="-1"></a><span class="in">dollar_allocation &lt;- moderate_portfolio$weights * investment_amount</span></span>
<span id="cb39-512"><a href="#cb39-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-513"><a href="#cb39-513" aria-hidden="true" tabindex="-1"></a><span class="in">allocation_table &lt;- data.frame(</span></span>
<span id="cb39-514"><a href="#cb39-514" aria-hidden="true" tabindex="-1"></a><span class="in">  Company = company_names,</span></span>
<span id="cb39-515"><a href="#cb39-515" aria-hidden="true" tabindex="-1"></a><span class="in">  Symbol = tickers,</span></span>
<span id="cb39-516"><a href="#cb39-516" aria-hidden="true" tabindex="-1"></a><span class="in">  Weight = paste0(round(moderate_portfolio$weights * 100, 1), "%"),</span></span>
<span id="cb39-517"><a href="#cb39-517" aria-hidden="true" tabindex="-1"></a><span class="in">  Dollar_Amount = paste0("$", round(dollar_allocation, 0))</span></span>
<span id="cb39-518"><a href="#cb39-518" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb39-519"><a href="#cb39-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-520"><a href="#cb39-520" aria-hidden="true" tabindex="-1"></a><span class="in">kable(allocation_table, </span></span>
<span id="cb39-521"><a href="#cb39-521" aria-hidden="true" tabindex="-1"></a><span class="in">      caption = "Your Optimal Portfolio Allocation ($10,000 Investment)",</span></span>
<span id="cb39-522"><a href="#cb39-522" aria-hidden="true" tabindex="-1"></a><span class="in">      col.names = c("Company", "Symbol", "Weight", "Dollar Amount"))</span></span>
<span id="cb39-523"><a href="#cb39-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-524"><a href="#cb39-524" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Portfolio Statistics:\n")</span></span>
<span id="cb39-525"><a href="#cb39-525" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Expected Annual Return:", round(moderate_portfolio$expected_return * 100, 2), "%\n")</span></span>
<span id="cb39-526"><a href="#cb39-526" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Expected Annual Risk:", round(moderate_portfolio$volatility * 100, 2), "%\n")</span></span>
<span id="cb39-527"><a href="#cb39-527" aria-hidden="true" tabindex="-1"></a><span class="in">cat("Sharpe Ratio:", round(moderate_portfolio$sharpe_ratio, 3), "\n")</span></span>
<span id="cb39-528"><a href="#cb39-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-529"><a href="#cb39-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-530"><a href="#cb39-530" aria-hidden="true" tabindex="-1"></a><span class="fu">## Advantages of Mean Variance Optimization</span></span>
<span id="cb39-531"><a href="#cb39-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-532"><a href="#cb39-532" aria-hidden="true" tabindex="-1"></a>Mean Variance Optimization offers several significant advantages that have established it as the foundation of modern portfolio theory:</span>
<span id="cb39-533"><a href="#cb39-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-534"><a href="#cb39-534" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. **Mathematical Rigor and Theoretical Foundation**</span></span>
<span id="cb39-535"><a href="#cb39-535" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provides a mathematically sound framework for portfolio construction</span>
<span id="cb39-536"><a href="#cb39-536" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Based on axiomatic utility theory and rational choice principles</span>
<span id="cb39-537"><a href="#cb39-537" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Offers closed-form solutions through quadratic programming</span>
<span id="cb39-538"><a href="#cb39-538" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Recognized with the 1990 Nobel Prize in Economic Sciences</span>
<span id="cb39-539"><a href="#cb39-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-540"><a href="#cb39-540" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. **Systematic Risk Management**</span></span>
<span id="cb39-541"><a href="#cb39-541" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Explicitly incorporates correlation structures between assets</span>
<span id="cb39-542"><a href="#cb39-542" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Quantifies diversification benefits through mathematical optimization</span>
<span id="cb39-543"><a href="#cb39-543" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provides optimal trade-off between risk and expected return</span>
<span id="cb39-544"><a href="#cb39-544" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Enables precise measurement of portfolio risk characteristics</span>
<span id="cb39-545"><a href="#cb39-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-546"><a href="#cb39-546" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. **Flexibility and Customization**</span></span>
<span id="cb39-547"><a href="#cb39-547" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accommodates various investor preferences through utility functions</span>
<span id="cb39-548"><a href="#cb39-548" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Supports multiple optimization objectives (risk minimization, return maximization)</span>
<span id="cb39-549"><a href="#cb39-549" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Allows incorporation of investment constraints and preferences</span>
<span id="cb39-550"><a href="#cb39-550" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Scalable to portfolios of any size or complexity</span>
<span id="cb39-551"><a href="#cb39-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-552"><a href="#cb39-552" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. **Empirical and Practical Applications**</span></span>
<span id="cb39-553"><a href="#cb39-553" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Serves as foundation for Capital Asset Pricing Model (CAPM)</span>
<span id="cb39-554"><a href="#cb39-554" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Enables construction of efficient frontiers for investment analysis</span>
<span id="cb39-555"><a href="#cb39-555" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provides benchmark for portfolio performance evaluation</span>
<span id="cb39-556"><a href="#cb39-556" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Supports asset allocation decisions across institutional and retail contexts</span>
<span id="cb39-557"><a href="#cb39-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-558"><a href="#cb39-558" aria-hidden="true" tabindex="-1"></a><span class="fu">## Limitations and Critical Assessment</span></span>
<span id="cb39-559"><a href="#cb39-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-560"><a href="#cb39-560" aria-hidden="true" tabindex="-1"></a>Despite its theoretical elegance and practical utility, Mean Variance Optimization faces several important limitations that affect its real-world application:</span>
<span id="cb39-561"><a href="#cb39-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-562"><a href="#cb39-562" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. **Parameter Estimation Risk**</span></span>
<span id="cb39-563"><a href="#cb39-563" aria-hidden="true" tabindex="-1"></a>**Problem:** Optimal portfolios are highly sensitive to input parameters (expected returns, volatilities, correlations).</span>
<span id="cb39-564"><a href="#cb39-564" aria-hidden="true" tabindex="-1"></a>**Academic Evidence:** Small estimation errors can lead to substantially different portfolio compositions.</span>
<span id="cb39-565"><a href="#cb39-565" aria-hidden="true" tabindex="-1"></a>**Mitigation Strategies:** Robust optimization techniques, Bayesian approaches, confidence intervals around estimates.</span>
<span id="cb39-566"><a href="#cb39-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-567"><a href="#cb39-567" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. **Input Sensitivity and Instability**</span></span>
<span id="cb39-568"><a href="#cb39-568" aria-hidden="true" tabindex="-1"></a>**Problem:** Minor changes in expected return estimates can result in dramatically different optimal allocations.</span>
<span id="cb39-569"><a href="#cb39-569" aria-hidden="true" tabindex="-1"></a>**Practical Impact:** Portfolio turnover becomes excessive, leading to high transaction costs.</span>
<span id="cb39-570"><a href="#cb39-570" aria-hidden="true" tabindex="-1"></a>**Solutions:** Regularization methods, constrained optimization, resampling techniques.</span>
<span id="cb39-571"><a href="#cb39-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-572"><a href="#cb39-572" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. **Concentration Risk**</span></span>
<span id="cb39-573"><a href="#cb39-573" aria-hidden="true" tabindex="-1"></a>**Problem:** Unconstrained optimization often produces portfolios with extreme position weights.</span>
<span id="cb39-574"><a href="#cb39-574" aria-hidden="true" tabindex="-1"></a>**Theoretical Basis:** Optimizer exploits small differences in expected returns to generate concentrated positions.</span>
<span id="cb39-575"><a href="#cb39-575" aria-hidden="true" tabindex="-1"></a>**Practical Solutions:** Position limits, diversification constraints, risk budgeting approaches.</span>
<span id="cb39-576"><a href="#cb39-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-577"><a href="#cb39-577" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. **Distributional Assumptions**</span></span>
<span id="cb39-578"><a href="#cb39-578" aria-hidden="true" tabindex="-1"></a>**Problem:** Normal distribution assumption fails to capture tail risks and extreme market events.</span>
<span id="cb39-579"><a href="#cb39-579" aria-hidden="true" tabindex="-1"></a>**Empirical Evidence:** Financial returns exhibit fat tails, skewness, and time-varying volatility.</span>
<span id="cb39-580"><a href="#cb39-580" aria-hidden="true" tabindex="-1"></a>**Alternative Approaches:** Conditional Value-at-Risk (CVaR), higher-moment optimization, regime-switching models.</span>
<span id="cb39-581"><a href="#cb39-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-582"><a href="#cb39-582" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5. **Single-Period Limitation**</span></span>
<span id="cb39-583"><a href="#cb39-583" aria-hidden="true" tabindex="-1"></a>**Problem:** Framework assumes static single-period investment horizon.</span>
<span id="cb39-584"><a href="#cb39-584" aria-hidden="true" tabindex="-1"></a>**Reality:** Investors face multi-period investment decisions with changing opportunity sets.</span>
<span id="cb39-585"><a href="#cb39-585" aria-hidden="true" tabindex="-1"></a>**Extensions:** Dynamic programming, stochastic control theory, multi-period mean-variance models.</span>
<span id="cb39-586"><a href="#cb39-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-587"><a href="#cb39-587" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6. **Market Frictions**</span></span>
<span id="cb39-588"><a href="#cb39-588" aria-hidden="true" tabindex="-1"></a>**Problem:** Model ignores transaction costs, taxes, liquidity constraints, and market impact.</span>
<span id="cb39-589"><a href="#cb39-589" aria-hidden="true" tabindex="-1"></a>**Practical Significance:** Trading costs can exceed optimization benefits, particularly for high-turnover strategies.</span>
<span id="cb39-590"><a href="#cb39-590" aria-hidden="true" tabindex="-1"></a>**Implementation Solutions:** Transaction cost models, turnover constraints, liquidity-adjusted optimization.</span>
<span id="cb39-591"><a href="#cb39-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-592"><a href="#cb39-592" aria-hidden="true" tabindex="-1"></a><span class="fu">## Improving Mean Variance Optimization</span></span>
<span id="cb39-593"><a href="#cb39-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-594"><a href="#cb39-594" aria-hidden="true" tabindex="-1"></a>Here are some practical ways to make Mean Variance Optimization more robust:</span>
<span id="cb39-595"><a href="#cb39-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-596"><a href="#cb39-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r improvements}</span></span>
<span id="cb39-597"><a href="#cb39-597" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: improvements</span></span>
<span id="cb39-598"><a href="#cb39-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-599"><a href="#cb39-599" aria-hidden="true" tabindex="-1"></a><span class="in"># 1. Add constraints to prevent extreme allocations</span></span>
<span id="cb39-600"><a href="#cb39-600" aria-hidden="true" tabindex="-1"></a><span class="in">optimize_portfolio_constrained &lt;- function(target_return, min_weight = 0.05, max_weight = 0.4) {</span></span>
<span id="cb39-601"><a href="#cb39-601" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-602"><a href="#cb39-602" aria-hidden="true" tabindex="-1"></a><span class="in">  # Enhanced constraints</span></span>
<span id="cb39-603"><a href="#cb39-603" aria-hidden="true" tabindex="-1"></a><span class="in">  Amat &lt;- rbind(</span></span>
<span id="cb39-604"><a href="#cb39-604" aria-hidden="true" tabindex="-1"></a><span class="in">    rep(1, n_assets),           # weights sum to 1</span></span>
<span id="cb39-605"><a href="#cb39-605" aria-hidden="true" tabindex="-1"></a><span class="in">    mu,                  # target return constraint</span></span>
<span id="cb39-606"><a href="#cb39-606" aria-hidden="true" tabindex="-1"></a><span class="in">    diag(n_assets),            # weights &gt;= min_weight</span></span>
<span id="cb39-607"><a href="#cb39-607" aria-hidden="true" tabindex="-1"></a><span class="in">    -diag(n_assets)            # weights &lt;= max_weight</span></span>
<span id="cb39-608"><a href="#cb39-608" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb39-609"><a href="#cb39-609" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-610"><a href="#cb39-610" aria-hidden="true" tabindex="-1"></a><span class="in">  bvec &lt;- c(1, target_return, rep(min_weight, n_assets), rep(-max_weight, n_assets))</span></span>
<span id="cb39-611"><a href="#cb39-611" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-612"><a href="#cb39-612" aria-hidden="true" tabindex="-1"></a><span class="in">  solution &lt;- solve.QP(Dmat = 2*Sigma, dvec = rep(0, n_assets), </span></span>
<span id="cb39-613"><a href="#cb39-613" aria-hidden="true" tabindex="-1"></a><span class="in">                      Amat = t(Amat), bvec = bvec, meq = 2)</span></span>
<span id="cb39-614"><a href="#cb39-614" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-615"><a href="#cb39-615" aria-hidden="true" tabindex="-1"></a><span class="in">  weights &lt;- solution$solution</span></span>
<span id="cb39-616"><a href="#cb39-616" aria-hidden="true" tabindex="-1"></a><span class="in">  names(weights) &lt;- tickers</span></span>
<span id="cb39-617"><a href="#cb39-617" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-618"><a href="#cb39-618" aria-hidden="true" tabindex="-1"></a><span class="in">  port_return &lt;- sum(weights * mu)</span></span>
<span id="cb39-619"><a href="#cb39-619" aria-hidden="true" tabindex="-1"></a><span class="in">  port_risk &lt;- sqrt(t(weights) %*% Sigma %*% weights)</span></span>
<span id="cb39-620"><a href="#cb39-620" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb39-621"><a href="#cb39-621" aria-hidden="true" tabindex="-1"></a><span class="in">  return(list(</span></span>
<span id="cb39-622"><a href="#cb39-622" aria-hidden="true" tabindex="-1"></a><span class="in">    weights = weights,</span></span>
<span id="cb39-623"><a href="#cb39-623" aria-hidden="true" tabindex="-1"></a><span class="in">    expected_return = port_return,</span></span>
<span id="cb39-624"><a href="#cb39-624" aria-hidden="true" tabindex="-1"></a><span class="in">    volatility = as.numeric(port_risk),</span></span>
<span id="cb39-625"><a href="#cb39-625" aria-hidden="true" tabindex="-1"></a><span class="in">    sharpe_ratio = port_return / as.numeric(port_risk)</span></span>
<span id="cb39-626"><a href="#cb39-626" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb39-627"><a href="#cb39-627" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb39-628"><a href="#cb39-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-629"><a href="#cb39-629" aria-hidden="true" tabindex="-1"></a><span class="in"># Compare constrained vs unconstrained</span></span>
<span id="cb39-630"><a href="#cb39-630" aria-hidden="true" tabindex="-1"></a><span class="in">unconstrained &lt;- optimize_portfolio(target_return = moderate_target_return)</span></span>
<span id="cb39-631"><a href="#cb39-631" aria-hidden="true" tabindex="-1"></a><span class="in">constrained &lt;- optimize_portfolio_constrained(target_return = moderate_target_return)</span></span>
<span id="cb39-632"><a href="#cb39-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-633"><a href="#cb39-633" aria-hidden="true" tabindex="-1"></a><span class="in">comparison &lt;- data.frame(</span></span>
<span id="cb39-634"><a href="#cb39-634" aria-hidden="true" tabindex="-1"></a><span class="in">  Approach = c("Unconstrained", "Constrained"),</span></span>
<span id="cb39-635"><a href="#cb39-635" aria-hidden="true" tabindex="-1"></a><span class="in">  Return = c(unconstrained$expected_return, constrained$expected_return),</span></span>
<span id="cb39-636"><a href="#cb39-636" aria-hidden="true" tabindex="-1"></a><span class="in">  Risk = c(unconstrained$volatility, constrained$volatility),</span></span>
<span id="cb39-637"><a href="#cb39-637" aria-hidden="true" tabindex="-1"></a><span class="in">  Sharpe = c(unconstrained$sharpe_ratio, constrained$sharpe_ratio),</span></span>
<span id="cb39-638"><a href="#cb39-638" aria-hidden="true" tabindex="-1"></a><span class="in">  Max_Weight = c(max(unconstrained$weights), max(constrained$weights)),</span></span>
<span id="cb39-639"><a href="#cb39-639" aria-hidden="true" tabindex="-1"></a><span class="in">  Min_Weight = c(min(unconstrained$weights), min(constrained$weights))</span></span>
<span id="cb39-640"><a href="#cb39-640" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb39-641"><a href="#cb39-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-642"><a href="#cb39-642" aria-hidden="true" tabindex="-1"></a><span class="in">kable(comparison, </span></span>
<span id="cb39-643"><a href="#cb39-643" aria-hidden="true" tabindex="-1"></a><span class="in">      caption = "Comparison: Constrained vs Unconstrained Optimization",</span></span>
<span id="cb39-644"><a href="#cb39-644" aria-hidden="true" tabindex="-1"></a><span class="in">      digits = 4)</span></span>
<span id="cb39-645"><a href="#cb39-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-646"><a href="#cb39-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-647"><a href="#cb39-647" aria-hidden="true" tabindex="-1"></a><span class="fu">## Best Practices for Practical Implementation</span></span>
<span id="cb39-648"><a href="#cb39-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-649"><a href="#cb39-649" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. **Robust Parameter Estimation**</span></span>
<span id="cb39-650"><a href="#cb39-650" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Employ multiple estimation methodologies rather than relying solely on historical averages</span>
<span id="cb39-651"><a href="#cb39-651" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Incorporate forward-looking information from analyst forecasts and economic models</span>
<span id="cb39-652"><a href="#cb39-652" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Utilize shrinkage estimators and Bayesian approaches to improve parameter stability</span>
<span id="cb39-653"><a href="#cb39-653" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Implement Black-Litterman methodology to combine market equilibrium with investor views</span>
<span id="cb39-654"><a href="#cb39-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-655"><a href="#cb39-655" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. **Portfolio Rebalancing Strategy**</span></span>
<span id="cb39-656"><a href="#cb39-656" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Establish systematic rebalancing schedules (quarterly, semi-annually) based on institutional constraints</span>
<span id="cb39-657"><a href="#cb39-657" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Monitor drift from target allocations and implement threshold-based rebalancing rules</span>
<span id="cb39-658"><a href="#cb39-658" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Account for transaction costs and tax implications in rebalancing decisions</span>
<span id="cb39-659"><a href="#cb39-659" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Consider regime changes and structural breaks in market conditions</span>
<span id="cb39-660"><a href="#cb39-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-661"><a href="#cb39-661" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. **Risk Management and Stress Testing**</span></span>
<span id="cb39-662"><a href="#cb39-662" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conduct scenario analysis and stress testing under extreme market conditions</span>
<span id="cb39-663"><a href="#cb39-663" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Implement Monte Carlo simulations to assess portfolio robustness</span>
<span id="cb39-664"><a href="#cb39-664" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Evaluate portfolio performance during historical crisis periods</span>
<span id="cb39-665"><a href="#cb39-665" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Monitor factor exposures and concentration risks continuously</span>
<span id="cb39-666"><a href="#cb39-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-667"><a href="#cb39-667" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. **Implementation Considerations**</span></span>
<span id="cb39-668"><a href="#cb39-668" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Begin with broad asset class allocation before proceeding to individual security selection</span>
<span id="cb39-669"><a href="#cb39-669" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Implement position limits and diversification constraints to prevent excessive concentration</span>
<span id="cb39-670"><a href="#cb39-670" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Account for implementation costs including bid-ask spreads, market impact, and custody fees</span>
<span id="cb39-671"><a href="#cb39-671" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Consider investment vehicle efficiency (ETFs, index funds) versus direct security holdings</span>
<span id="cb39-672"><a href="#cb39-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-673"><a href="#cb39-673" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5. **Institutional and Regulatory Constraints**</span></span>
<span id="cb39-674"><a href="#cb39-674" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Incorporate investment policy constraints and regulatory requirements</span>
<span id="cb39-675"><a href="#cb39-675" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Consider liability matching for institutional investors (pension funds, insurance companies)</span>
<span id="cb39-676"><a href="#cb39-676" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Account for liquidity requirements and redemption patterns</span>
<span id="cb39-677"><a href="#cb39-677" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Evaluate ESG (Environmental, Social, Governance) constraints and preferences</span>
<span id="cb39-678"><a href="#cb39-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-679"><a href="#cb39-679" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary and Conclusions</span></span>
<span id="cb39-680"><a href="#cb39-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-681"><a href="#cb39-681" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb39-682"><a href="#cb39-682" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Research Findings</span></span>
<span id="cb39-683"><a href="#cb39-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-684"><a href="#cb39-684" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Theoretical Foundation:** Mean Variance Optimization provides a rigorous mathematical framework for portfolio construction based on expected utility maximization</span>
<span id="cb39-685"><a href="#cb39-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-686"><a href="#cb39-686" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Empirical Application:** The methodology successfully identifies efficient portfolios that optimize the risk-return trade-off within the constraints of available data</span>
<span id="cb39-687"><a href="#cb39-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-688"><a href="#cb39-688" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Diversification Benefits:** Mathematical optimization quantifies and captures correlation-based diversification effects that reduce portfolio risk</span>
<span id="cb39-689"><a href="#cb39-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-690"><a href="#cb39-690" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Implementation Challenges:** Parameter sensitivity and estimation risk represent significant practical limitations requiring robust mitigation strategies</span>
<span id="cb39-691"><a href="#cb39-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-692"><a href="#cb39-692" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Risk Management Integration:** Optimal portfolio construction must incorporate realistic constraints, transaction costs, and ongoing risk monitoring</span>
<span id="cb39-693"><a href="#cb39-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-694"><a href="#cb39-694" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Academic and Practical Relevance:** Despite limitations, MVO remains the foundation for modern portfolio theory and continues to inform institutional investment practices</span>
<span id="cb39-695"><a href="#cb39-695" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-696"><a href="#cb39-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-697"><a href="#cb39-697" aria-hidden="true" tabindex="-1"></a>Mean Variance Optimization represents a fundamental breakthrough in quantitative finance, providing the theoretical foundation for modern portfolio management. While practical implementation requires careful attention to parameter estimation, constraints, and market frictions, the framework continues to serve as the cornerstone of systematic investment management.</span>
<span id="cb39-698"><a href="#cb39-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-699"><a href="#cb39-699" aria-hidden="true" tabindex="-1"></a>The methodology's enduring influence stems from its mathematical rigor and practical applicability across diverse investment contexts. Students and practitioners should understand both the theoretical elegance and practical limitations of the approach, using it as a starting point for more sophisticated portfolio construction methodologies.</span>
<span id="cb39-700"><a href="#cb39-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-701"><a href="#cb39-701" aria-hidden="true" tabindex="-1"></a><span class="fu">## References and Further Reading</span></span>
<span id="cb39-702"><a href="#cb39-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-703"><a href="#cb39-703" aria-hidden="true" tabindex="-1"></a><span class="fu">### Foundational Academic Literature</span></span>
<span id="cb39-704"><a href="#cb39-704" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Markowitz, H. (1952).** "Portfolio Selection." *Journal of Finance*, 7(1), 77-91. <span class="co">[</span><span class="ot">Seminal paper introducing mean-variance optimization</span><span class="co">]</span></span>
<span id="cb39-705"><a href="#cb39-705" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Sharpe, W. F. (1964).** "Capital Asset Prices: A Theory of Market Equilibrium under Conditions of Risk." *Journal of Finance*, 19(3), 425-442. <span class="co">[</span><span class="ot">Development of CAPM based on Markowitz framework</span><span class="co">]</span></span>
<span id="cb39-706"><a href="#cb39-706" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Black, F., &amp; Litterman, R. (1992).** "Global Portfolio Optimization." *Financial Analysts Journal*, 48(5), 28-43. <span class="co">[</span><span class="ot">Bayesian approach to parameter estimation</span><span class="co">]</span></span>
<span id="cb39-707"><a href="#cb39-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-708"><a href="#cb39-708" aria-hidden="true" tabindex="-1"></a><span class="fu">### Advanced Theoretical Developments</span></span>
<span id="cb39-709"><a href="#cb39-709" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Merton, R. C. (1972).** "An Analytic Derivation of the Efficient Portfolio Frontier." *Journal of Financial and Quantitative Analysis*, 7(4), 1851-1872.</span>
<span id="cb39-710"><a href="#cb39-710" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Jobson, J. D., &amp; Korkie, B. (1980).** "Estimation for Markowitz Efficient Portfolios." *Journal of the American Statistical Association*, 75(371), 544-554.</span>
<span id="cb39-711"><a href="#cb39-711" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Michaud, R. O. (1989).** "The Markowitz Optimization Enigma: Is 'Optimized' Optimal?" *Financial Analysts Journal*, 45(1), 31-42.</span>
<span id="cb39-712"><a href="#cb39-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-713"><a href="#cb39-713" aria-hidden="true" tabindex="-1"></a><span class="fu">### Contemporary Research and Extensions</span></span>
<span id="cb39-714"><a href="#cb39-714" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**DeMiguel, V., Garlappi, L., &amp; Uppal, R. (2009).** "Optimal Versus Naive Diversification: How Inefficient is the 1/N Portfolio Strategy?" *Review of Financial Studies*, 22(5), 1915-1953.</span>
<span id="cb39-715"><a href="#cb39-715" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>**Ledoit, O., &amp; Wolf, M. (2003).** "Improved Estimation of the Covariance Matrix of Stock Returns With an Application to Portfolio Selection." *Journal of Empirical Finance*, 10(5), 603-621.</span>
<span id="cb39-716"><a href="#cb39-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-717"><a href="#cb39-717" aria-hidden="true" tabindex="-1"></a><span class="fu">### Textbooks and Comprehensive References</span></span>
<span id="cb39-718"><a href="#cb39-718" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Elton, E. J., Gruber, M. J., Brown, S. J., &amp; Goetzmann, W. N. (2014).** *Modern Portfolio Theory and Investment Analysis* (9th ed.). John Wiley &amp; Sons.</span>
<span id="cb39-719"><a href="#cb39-719" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Bodie, Z., Kane, A., &amp; Marcus, A. J. (2021).** *Investments* (12th ed.). McGraw-Hill Education.</span>
<span id="cb39-720"><a href="#cb39-720" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Campbell, J. Y., Lo, A. W., &amp; MacKinlay, A. C. (1997).** *The Econometrics of Financial Markets*. Princeton University Press.</span>
<span id="cb39-721"><a href="#cb39-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-722"><a href="#cb39-722" aria-hidden="true" tabindex="-1"></a><span class="fu">### Computational Resources for R</span></span>
<span id="cb39-723"><a href="#cb39-723" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**`PerformanceAnalytics`** - Comprehensive portfolio performance analysis and risk management</span>
<span id="cb39-724"><a href="#cb39-724" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**`quadprog`** - Quadratic programming for mean-variance optimization</span>
<span id="cb39-725"><a href="#cb39-725" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**`fPortfolio`** - Advanced portfolio optimization and backtesting framework</span>
<span id="cb39-726"><a href="#cb39-726" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**`quantmod`** - Quantitative financial modeling and data management</span>
<span id="cb39-727"><a href="#cb39-727" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**`PortfolioAnalytics`** - Flexible portfolio optimization with multiple objectives</span>
<span id="cb39-728"><a href="#cb39-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-729"><a href="#cb39-729" aria-hidden="true" tabindex="-1"></a><span class="fu">### Professional and Institutional Resources</span></span>
<span id="cb39-730"><a href="#cb39-730" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**CFA Institute Research Foundation** - Applied portfolio management research</span>
<span id="cb39-731"><a href="#cb39-731" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Journal of Portfolio Management** - Practitioner-oriented portfolio theory research  </span>
<span id="cb39-732"><a href="#cb39-732" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**CRAN Task View: Finance** - Comprehensive listing of R packages for computational finance</span>
<span id="cb39-733"><a href="#cb39-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-734"><a href="#cb39-734" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regulatory and Industry Standards</span></span>
<span id="cb39-735"><a href="#cb39-735" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**GIPS Standards** - Global Investment Performance Standards for portfolio measurement</span>
<span id="cb39-736"><a href="#cb39-736" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Risk Management Guidelines** - Basel Committee and regulatory frameworks for institutional risk management</span>
<span id="cb39-737"><a href="#cb39-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-738"><a href="#cb39-738" aria-hidden="true" tabindex="-1"></a>**Disclaimer:** This article is intended for educational purposes only and does not constitute investment advice. Students and practitioners should consult qualified financial professionals before making investment decisions and consider the regulatory requirements applicable to their jurisdiction.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>